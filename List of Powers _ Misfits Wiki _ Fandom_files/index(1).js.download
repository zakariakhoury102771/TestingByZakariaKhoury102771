/*! For license information please see index.js.LICENSE.txt */
(()=>{var t,e,i={9028:t=>{function e(t,e){return Object.keys(e).forEach((function(i){"default"===i||"__esModule"===i||t.hasOwnProperty(i)||Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[i]}})})),t}function i(t,e,i,n){Object.defineProperty(t,e,{get:i,set:n,enumerable:!0,configurable:!0})}i(t.exports,"utils",(()=>n));var n={},o={};function r(t){return new Promise((e=>setTimeout((()=>e()),t)))}i(o,"delay",(()=>r));var s={};function a(){const t=new URLSearchParams(window.location.search.substring(1));return Boolean(t.get("adengine_debug"))?t.get("adengine_debug"):t.get("identity_debug")}i(s,"getDebugGroup",(()=>a));var c={};i(c,"localStorageHelper",(()=>d));class d{constructor(t,e=6e4){this.key=t,this.ttlInMilliseconds=e;let i=!1;try{i=void 0!==window.localStorage&&null!==window.localStorage,i&&(window.localStorage.setItem("__test__","test"),window.localStorage.removeItem("__test__"))}catch(t){i=!1}const n=t=>window?.instantConfigCache?.[t]??null,o=(t,e)=>{void 0===window.instantConfigCache&&(window.instantConfigCache={}),window.instantConfigCache[t]=e};this.storageAdapter={getItem:t=>{try{return i?window.localStorage.getItem(t)??n(t):n(t)}catch(e){return n(t)}},setItem:(t,e)=>{try{if(i)return localStorage.setItem(t,e);o(t,e)}catch(i){o(t,e)}}}}set(t){const e=this.getObjectToStore(t);this.storageAdapter.setItem(this.key,JSON.stringify(e))}get(){const t=this.storageAdapter.getItem(this.key);return t?this.parseStoredValue(JSON.parse(t)):null}expired(t){return!t||t<Date.now()}getObjectToStore(t){return{data:t,ttl:Date.now()+this.ttlInMilliseconds}}parseStoredValue(t){return this.expired(t?.ttl)?null:t.data}}var u={};i(u,"lock",(()=>h)),i(u,"release",(()=>g));const l=new d("instant-config-lock",1e3);function h(){return"lock"===l.get()||(l.set("lock"),!1)}function g(){l.set(null)}var p={};i(p,"getTimeDelta",(()=>m)),i(p,"logger",(()=>b)),i(p,"warner",(()=>w));const f=a()||"",v=f.split(","),y=Date.now();function m(){return((Date.now()-(window.performance?.timeOrigin??y))/1e3).toFixed(4)}function b(t,...e){""!==f&&("1"!==f&&-1===v.indexOf(t)||window.console.info(`${m()}s\t\t ${t}`,e))}function w(t,...e){""!==f&&("1"!==f&&-1===v.indexOf(t)||window.console.warn(t,e))}e(n,s),e(n,p),e(n,o),e(n,c),e(n,u);var C={},O={};i(O,"EmptyInstantConfigCacheStorage",(()=>j));class j{get(t){}set(t){}remove(t){}}var S={};i(S,"InstantConfigInterpreter",(()=>Y));var k={},T={};function E(t){return Array.isArray(t)&&t.length>0&&"object"==typeof t[0]}i(T,"shouldBeListOfConfigGroups",(()=>E));var Q={};i(Q,"negativePrefix",(()=>I)),i(Q,"cacheSuffix",(()=>R)),i(Q,"samplingSeparator",(()=>_)),i(Q,"worldWide",(()=>A)),i(Q,"precision",(()=>M)),i(Q,"experimentBucketSettingKey",(()=>P));const I="non-",R="-cached",_="/",A="XX",M=10**6,P="eb";e(k,{}),e(k,{}),e(k,{}),e(k,T),e(k,{}),e(k,{}),e(k,{}),e(k,{}),e(k,{}),e(k,Q),e(k,{});class D{constructor(t,e,i){this.container=e,this.settingsRepository=i,"number"==typeof t?this.experimentBucket=this.manageSampling(t):!0===t?this.experimentBucket=this.manageSampling(0):!1===t?this.clean():this.experimentBucket=Math.round(100*Math.random())}build(){return()=>this.experimentBucket}manageSampling(t){const e=this.readFromLoaderVariable()??this.readFromSettings()??Math.round(100*Math.random());return this.storeInLoaderVariable(e),this.storeInSettings(e,t),e}readFromLoaderVariable(){return this.container.fandomContext?.experimentBucket}readFromSettings(){const t=this.settingsRepository&&this.settingsRepository.get(P);return t&&Number(t)}storeInSettings(t,e){this.settingsRepository&&this.settingsRepository.set(P,t.toString(),e)}storeInLoaderVariable(t){this.container.fandomContext=this.container.fandomContext||{},this.container.fandomContext.experimentBucket=t}clean(){this.settingsRepository&&this.settingsRepository.remove(P)}}var W={},x={};i(x,"BrowserMatcher",(()=>N));var L={};function G(t){return t.startsWith(I)?{value:t.replace(I,""),negated:!0}:{value:t,negated:!1}}i(L,"extractNegation",(()=>G));class N{constructor(t){this.currentBrowser=t?.toLowerCase()}isValid(t){const e=t.b??t.browsers??[],i=e.map((t=>t.toLowerCase())).map((t=>G(t)));return 0===e.length||!this.currentBrowser||!this.isCurrentNegated(this.currentBrowser,i)&&i.some((t=>this.currentBrowser.includes(t.value)!==t.negated))}isCurrentNegated(t,e){return e.some((e=>t.includes(e.value)&&e.negated))}}var V={};i(V,"DeviceMatcher",(()=>U));class U{constructor(t){this.currentDevice=t}isValid(t){const e=(t.d??t.devices??[]).map((t=>t.toLowerCase())).map((t=>G(t)));return 0===e.length||!this.currentDevice||!this.isCurrentNegated(this.currentDevice,e)&&e.some((t=>t.value===this.currentDevice!==t.negated))}isCurrentNegated(t,e){return e.some((e=>t.includes(e.value)&&e.negated))}}var F={};i(F,"DomainMatcher",(()=>H));class H{isValid(t){const e=t.o??t.domains??[];return 0===e.length||e.some((t=>window.location.hostname.includes(t)))}}var $={};i($,"RegionMatcher",(()=>B));class B{constructor(t){this.geo=t}isValid(t,e){const i=t.r??t.regions??[],n=this.filterOutInvalidRegions(i);return e?e(n):this.isProperGeo(n)}getCountryCode(){return this.geo?.country}getRegionCode(){return this.geo?.region}getContinentCode(){return this.geo?.continent}isProperGeo(t=[]){return!(!t||!t.indexOf||this.isGeoExcluded(t)||!(this.isProperContinent(t)||this.isProperCountry(t)||this.isProperRegion(t)))}filterOutInvalidRegions(t){return t.filter((t=>!t.includes(_))).filter((t=>!t.includes(R)))}isProperCountry(t){return!!(t&&t.indexOf&&(t.indexOf(this.getCountryCode())>-1||this.isSampledForGeo(t,this.getCountryCode())))}isProperRegion(t){const e=`${this.getCountryCode()}-${this.getRegionCode()}`;return!!(t&&t.indexOf&&(t.indexOf(e)>-1||this.isSampledForGeo(t,e)))}containsContinent(t){const e=`${A}-${this.getContinentCode()}`;return t.indexOf(e)>-1||this.isSampledForGeo(t,e)}containsWorldWide(t){return t.indexOf(A)>-1||this.isSampledForGeo(t,A)}isProperContinent(t){return!(!t||!t.indexOf||!this.containsWorldWide(t)&&!this.containsContinent(t))}isGeoExcluded(t){return!!(t.indexOf(`${I}${this.getCountryCode()}`)>-1||t.indexOf(`${I}${this.getCountryCode()}-${this.getRegionCode()}`)>-1||t.indexOf(`${I}${A}-${this.getContinentCode()}`)>-1)}hasSampling(t){return e=>0!==e.indexOf(I)&&e.indexOf(t+_)>-1}getSamplingLimits(t){let[,e]=t.split(_);return e=e.replace(R,""),Math.round(parseFloat(e)*M)||0}isSampledForGeo(t,e){const i=t.filter(this.hasSampling(e));if(0===i.length)return!1;const n=Math.round(Math.random()*(100*M))||0;return i.map((t=>this.getSamplingLimits(t))).some((t=>n<t))}}var q={};i(q,"SamplingCacheManager",(()=>z));class z{constructor(t){this.cacheStorage=t,this.precision=10**6,this.samplingProvider=()=>100*Math.random()}setSamplingProvider(t){this.samplingProvider=t}apply(t,e,i){const n=this.cacheStorage.get(t);if(void 0!==n){if(this.isCachedValueValid(n,e))return n.result;this.cacheStorage.remove(t)}const o=i(),r=e.s??e.sampling,s=e.c??e.samplingCache;if("number"!=typeof r||!1===o)return o;const a=this.getSamplingResult(r),c={name:t,result:a,withCookie:Boolean(s),group:a?"B":"A",limit:this.getLimit(a,r)};return this.cacheStorage.set(c),a}getSamplingResult(t){const e=Math.round(this.samplingProvider()*this.precision);return Math.round(t*this.precision)>e}isCachedValueValid(t,e){return e.samplingCache&&"number"==typeof e.sampling&&t.limit==this.getLimit(t.result,e.sampling)}getLimit(t,e){return+(t?e:100-e).toFixed(6)}}e(W,x),e(W,V),e(W,F),e(W,L),e(W,$),e(W,q);class Y{constructor(t=new N,e=new U,i=new H,n=new B,o=new j,r){this.browserMatcher=t,this.deviceMatcher=e,this.domainMatcher=i,this.regionMatcher=n,this.settingsRepository=r,this.logGroup="instant-config-interpreter",this.configResponse={},this.samplingCache=new z(o)}init(t,e={},i,n=window){this.configResponse={...e,...t},this.regionValidationPredicate=i;const o=this.getValueWithoutCache("icExperimentBucket");if(void 0!==o){const t=new D(o,n,this.settingsRepository).build();this.samplingCache.setSamplingProvider(t)}return this}getValues(){return n.logger(this.logGroup,"get values called with",this.configResponse),Object.keys(this.configResponse).map((t=>({key:t,value:this.configResponse[t]}))).map((({key:t,value:e})=>E(e)?{key:t,value:this.getValueFromGroups(t,e)}:{key:t,value:e})).reduce(((t,e)=>({...t,[e.key]:e.value})),{})}getValueWithoutCache(t){const e=this.configResponse[t];if(E(e)){const t=e.find(this.isValid.bind(this));return t&&(t.v??t.value)}return e}getValueFromGroups(t,e){const i=e.find(((e,i)=>this.samplingCache.apply(`${t}-${i}`,e,(()=>this.isValid(e)))));if(void 0!==i)return i.v??i.value}isValid(t){return this.browserMatcher.isValid(t)&&this.deviceMatcher.isValid(t)&&this.domainMatcher.isValid(t)&&this.regionMatcher.isValid(t,this.regionValidationPredicate)}}var K={};async function X(t,e=2e3){const i=new AbortController,n=setTimeout((()=>i.abort()),e),o=await fetch(t,{signal:i.signal});return clearTimeout(n),o}i(K,"InstantConfigLoader",(()=>Z));const J="instant-config-loader";class Z{constructor(t,e=window){this.params=t,this.container=e,this.storage=new n.localStorageHelper(`instant-config-${t.appName}`,6e4),this.container.icbm=this.container.icbm||{},this.instantConfig=this.container.instantConfig,this.lockDelay="number"==typeof t.lockDelay?t.lockDelay:500}async getConfig(){if(this.instantConfig)return this.instantConfig;let t;return this.lockDelay>0?t=this.fetchInstantConfigThroughCache():(this.container.icbm.fetch||(this.container.icbm.fetch=this.fetchInstantConfig()),t=this.container.icbm.fetch),t.then((t=>t??this.fetchFallbackConfig()))}async fetchInstantConfigThroughCache(t=!1){if(n.lock()&&!t)return n.logger(J,"locked, awaiting",this.lockDelay),await r(this.lockDelay),this.fetchInstantConfigThroughCache(!0);try{const t=this.storage.get();if(t)return n.logger(J,"instant config pulled from local storage",t),JSON.parse(t);const e=await this.fetchInstantConfig();return e&&this.storage.set(JSON.stringify(e)),n.release(),e}catch(t){n.warner(J,"could not get instant config via cache",t),n.release()}}async fetchInstantConfig(){const t=`${this.params.instantConfigEndpoint??"https://services.fandom.com"}/${this.params.instantConfigVariant??"icbm"}/api/config?app=${this.params.appName}`;try{const e=await X(t,this.params.requestTimeout);if(!e.ok)return;const i=await e.json();return n.logger(J,"instant config fetched",i),i}catch(t){return void n.warner(J,"could not fetch instant config",t)}}async fetchFallbackConfig(){n.logger(J,"Fetching fallback config");const t=this.params.instantConfigFallbackEndpoint;if(void 0===t)return{};try{n.logger(J,t);const e=await X(t,this.params.requestTimeout);if(!e.ok)return{};const i=await e.json();return n.logger(J,"fallback config fetched",i),i}catch(t){return n.warner(J,"could not fetch fallback config",t),{}}}}var tt={};i(tt,"InstantConfigOverrider",(()=>it));const et=["InstantGlobals","icbm"];class it{override(t,e){return[...t.keys()].filter((t=>{return e=t,et.some((t=>e.startsWith(`${t}.`)||e.startsWith(`${t}__`)));var e})).map((t=>{const[,e]=t.split(".").map((t=>t.split("__"))).flat();return{paramKey:t,key:e}})).map((({paramKey:e,key:i})=>({key:i,value:this.parseValue(t.get(e))}))).reduce(((t,{key:e,value:i})=>({...t,[e]:i})),e)}parseValue(t){if("true"===t||"false"===t)return"true"===t;const e=parseInt(t,10);if(t===`${e}`)return e;try{return JSON.parse(t)}catch(e){return t||null}}}e(C,O),e(C,S),e(C,K),e(C,tt),e(C,W),e(t.exports,C),e(t.exports,k)},5369:(t,e,i)=>{"use strict";i.d(e,{t:()=>n});class n{constructor(t){this.options=t,this.tags={},this.errorQueue=[]}get inserted(){return Array.from(document.getElementsByTagName("script")).some((t=>t.src===n.SENTRY_SCRIPT_CDN_URL))}get shouldLoad(){return Math.random()<this.options.sampleRate&&void 0!==n.ALLOWED_URLS.find((t=>window.location.hostname.includes(t)))}get loaded(){return void 0!==window.Sentry}get initialized(){return void 0!==this.scope}setTags(t){this.tags=t}captureException(t){if(console.error(`[IE] (${this.options.release} ${this.options.environment}) Error captured:`,t),"development"!==this.options.environment&&this.shouldLoad){if(!this.inserted)return this.errorQueue.push(t),void this.loadSentry();if(!this.loaded)return this.errorQueue.push(t),void this.loadSentry();this.initialized||this.createSentryInstance(),this.scope.captureException(t)}}loadSentry(){return void 0===this.loadPromise&&(this.loadPromise=new Promise((t=>{const e=document.createElement("script");e.defer=!0,e.src=n.SENTRY_SCRIPT_CDN_URL,e.crossOrigin="anonymous",e.integrity=n.SENTRY_SCRIPT_INTEGRITY,e.onload=()=>{this.createSentryInstance(),this.flushErrorQueue(),t()},document.getElementsByTagName("script")[0].parentNode.append(e)}))),this.loadPromise}createSentryInstance(){const{breadcrumbsIntegration:t,BrowserClient:e,dedupeIntegration:i,defaultStackParser:n,httpContextIntegration:o,linkedErrorsIntegration:r,makeFetchTransport:s,Scope:a}=window.Sentry,c=new e(Object.assign(Object.assign({},this.options),{sampleRate:1,transport:s,stackParser:n,integrations:[t(),i(),o(),r()]}));this.scope=new a,this.scope.setClient(c),this.scope.setTags(Object.assign({url:window.location.href,userAgent:window.navigator.userAgent},this.tags))}flushErrorQueue(){this.errorQueue.forEach((t=>{var e;return null===(e=this.scope)||void 0===e?void 0:e.captureException(t)}))}}n.ALLOWED_URLS=["fandom.com","fanatical.com","futhead.com","gamespot.com","giantbomb.com","metacritic.com","muthead.com","tvguide.com"],n.SENTRY_SCRIPT_CDN_URL="//browser.sentry-cdn.com/7.105.0/bundle.min.js",n.SENTRY_SCRIPT_INTEGRITY="sha384-iP5xIlbkWonIse3OwYtwpMAWScjrivRx8HUwVQK36MIK1LWXNF4oaIysvubyRK9V"},3155:(t,e,i)=>{"use strict";i.d(e,{r:()=>n});class n{constructor(t,e){this.__global=!0,this.timestamp=Date.now(),this.name=t.name,this.category=t.category||"[Identity]",this.type=`${this.category} ${t.name}`,Object.assign(this,e)}}},4085:(t,e,i)=>{"use strict";i.d(e,{U:()=>S});var n=i(1635),o=function(){return o=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},o.apply(this,arguments)},r={channelId:"default",host:window,coordinatorHost:window.top},s={connect:"connect",connected:"connected"},a="@wikia/post-quecast";function c(t){return t.channelId&&t.libId===a&&t.action&&function(t){return"string"==typeof t.type&&"number"==typeof t.timestamp}(t.action)}function d(t){return!t.data.private}function u(t,e){return t.data.channelId===e}function l(t){return t.data.action}var h=function(){function t(){}return t.make=function(t){return function(t){var e;return t.host===t.coordinatorHost&&!!(null===(e=t.coordinatorHost[a])||void 0===e?void 0:e.callbackConnector)}(t)?t.coordinatorHost[a].callbackConnector:new p({senderHost:t.coordinatorHost,listenerHost:t.host})},t}(),g=function(){function t(t){this.coordinatorHost=t,this.callbacks=[]}return t.prototype.dispatch=function(t){var e=this;if(!c(t))throw new Error("Incorrect object type. Expected PostMessageData, but got "+t);this.callbacks.forEach((function(i){return i({data:t,source:e.coordinatorHost})}))},t.prototype.addListener=function(t){this.callbacks.push(t)},t.prototype.removeListener=function(t){this.callbacks=this.callbacks.filter((function(e){return e!==t}))},t}(),p=function(){function t(t){this.options=t,this.map=new Map}return t.prototype.dispatch=function(t){if(!c(t))throw new Error("Incorrect object type. Expected PostMessageData, but got "+t);this.options.senderHost.postMessage(t,"*")},t.prototype.addListener=function(t){var e=function(e){var i;(i=e)&&i.source&&i.data&&c(i.data)&&t(e)};this.map.set(t,e),this.options.listenerHost.addEventListener("message",e)},t.prototype.removeListener=function(t){var e=this.map.get(t);this.options.listenerHost.removeEventListener("message",e),this.map.delete(t)},t}(),f=function(){function t(t){this.callbacks=[],this.history=[],this.channelId=t.channelId,this.connector=h.make(t),this.setupActions(),this.setupConnection()}return t.prototype.setupActions=function(){this.getHistory(),this.listenEvent()},t.prototype.getHistory=function(){var t=this,e=function(i){if(u(i,t.channelId)&&function(t){return!!t.data.private}(i)){var n=l(i);(function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return e.some((function(e){return t.type===e}))})(n,s.connected)&&(t.connector.removeListener(e),t.handleActions.apply(t,n.history))}};this.connector.addListener(e)},t.prototype.listenEvent=function(){var t=this;this.connector.addListener((function(e){if(u(e,t.channelId)&&d(e)){var i=l(e);t.handleActions(i)}}))},t.prototype.handleActions=function(){for(var t,e=this,i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];(t=this.history).push.apply(t,i),i.forEach((function(t){return e.callbacks.forEach((function(e){return e(t)}))}))},t.prototype.setupConnection=function(){this.connector.dispatch({action:{type:s.connect,timestamp:Date.now()},channelId:this.channelId,private:!0,libId:a})},t.prototype.addListener=function(t){this.history.forEach((function(e){return t(e)})),this.callbacks.push(t)},t.prototype.removeListener=function(t){this.callbacks=this.callbacks.filter((function(e){return e!==t}))},t}(),v=function(){function t(t){void 0===t&&(t={});var e=o(o({},r),t);this.channelId=e.channelId,this.connector=h.make(e)}return t.prototype.dispatch=function(t){this.connector.dispatch({action:o(o({},t),{timestamp:Date.now()}),channelId:this.channelId,private:!0,libId:a})},t}(),y=function(){function t(t){void 0===t&&(t={});var e=o(o({},r),t);this.transmitter=new v(e),this.receiver=new f(e)}return t.prototype.dispatch=function(t){this.transmitter.dispatch(t)},t.prototype.addListener=function(t){this.receiver.addListener(t)},t.prototype.removeListener=function(t){this.receiver.removeListener(t)},t}(),m=function(){function t(t,e){this.channelId=t,this.connectors=new Map,this.history=[],this.connectors.set(e,e[a].callbackConnector)}return t.prototype.addConnection=function(t){this.ensureConnector(t).dispatch({action:this.createConnectedAction(),private:!0,channelId:this.channelId,libId:a})},t.prototype.createConnectedAction=function(){return{type:s.connected,history:this.history,timestamp:Date.now()}},t.prototype.broadcast=function(t){var e=this;this.history.push(t),this.connectors.forEach((function(i){i.dispatch({action:t,channelId:e.channelId,libId:a})}))},t.prototype.ensureConnector=function(t){return this.connectors.has(t)||this.connectors.set(t,new p({senderHost:t,listenerHost:t})),this.connectors.get(t)},t}(),b=function(){function t(t){this.coordinatorHost=t,this.channels=new Map,this.callbackConnector=new g(t),this.postMessageConnector=new p({senderHost:t,listenerHost:t})}return t.prototype.init=function(){var t=this,e=function(e){d(e)||(t.handleConnect(e),t.handleBroadcast(e))};this.callbackConnector.addListener(e),this.postMessageConnector.addListener(e)},t.prototype.handleConnect=function(t){(function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return e.some((function(e){return t.data.action.type===e}))})(t,s.connect)&&this.ensureChannel(t.data.channelId).addConnection(t.source)},t.prototype.handleBroadcast=function(t){(function(t){return!Object.values(s).some((function(e){return t.data.action.type===e}))})(t)&&this.ensureChannel(t.data.channelId).broadcast(t.data.action)},t.prototype.ensureChannel=function(t){return this.channels.has(t)||this.channels.set(t,new m(t,this.coordinatorHost)),this.channels.get(t)},t}();function w(t){if(void 0===t&&(t=window),!t[a]){var e=new b(t);e.init(),t[a]=e}}var C,O=i(2223),j=i(7393);let S=class{constructor(t){this.window=t,this.history=new Map;const{channelId:e,coordinatorName:i}=this.getSettings();w(),this.communicator=new y({channelId:e||"default",coordinatorHost:t[i]||top})}emit(t){this.communicator.dispatch(t)}on(t,e){this.communicator.addListener((i=>this.run(i,t,e)))}once(t,e){this.communicator.addListener((i=>this.runOnce(i,t,e)))}getSettings(){return this.window["@wikia/post-quecast-settings"]||{}}run(t,e,i){this.ofType(t,e)&&i(t)}runOnce(t,e,i){const n=e.category+" "+e.name;this.ofType(t,e)&&(this.history.has(n)||(this.history.set(n,!0),i(t)))}ofType(t,e){return t.category===e.category&&t.name===e.name||t.type===e.category+" "+e.name}};S=(0,n.Cg)([(0,O.Gr)(),(0,n.Qj)(0,(0,O.WQ)(j.jf)),(0,n.Sn)("design:paramtypes",["function"==typeof(C="undefined"!=typeof Window&&Window)?C:Object])],S)},2349:(t,e,i)=>{"use strict";i.d(e,{c:()=>n});const n={CONSENT_READY:{category:"[AdEngine OptIn]",name:"set opt in"},CONSENT_UPDATE:{category:"[AdEngine OptIn]",name:"update opt in"},IDENTITY_READY:{category:"[IdentityEngine]",name:"Identity ready"},SEND_ONETRUST_EVENTS:{category:"[IdentityEngine]",name:"Send OneTrust events"},IDENTITY_PARTNER_DATA_OBTAINED:{category:"[AdEngine]",name:"Identity partner data obtained"},AGE_GATE_DATA:{name:"Age gate result",category:"[Identity]"},PAGE_CHANGED:{name:"Page changed",category:"[Platform]"},INSTANT_CONFIG_CACHE_READY:{category:"[AdEngine]",name:"Instant Config cache ready"},AUDIGENT_SEGMENT_LIBRARY_LOADED:{name:"Audigent segment library loaded"},AUDIGENT_MATCHES_LIBRARY_LOADED:{name:"Audigent matches library loaded"},AUDIGENT_SEGMENTS_READY:{name:"Audigent segments ready"},EYEOTA_STARTED:{name:"Eyeota started"},EYEOTA_FAILED:{name:"Eyeota loading failed"},LIVE_CONNECT_STARTED:{name:"LiveConnect started"},LIVE_CONNECT_CACHED:{name:"LiveConnect data cached"},LIVE_CONNECT_RESPONDED_UUID:{name:"LiveConnect responded with UUID"}}},3841:(t,e,i)=>{"use strict";i.d(e,{X:()=>q});var n,o,r,s=i(1635),a=i(2223),c=i(5144),d=i(3858),u=i(2439),l=i(3710),h=i(6610);let g=class{constructor(t,e,i){this.adsContext=t,this.platform=e,this.device=i,this.skinMap={muthead:"turf",futhead:"turf",giantbomb:"giantbomb",gamefaqs:"gamefaqs",gamespot:"gamespot",metacritic:"metacritic","metacritic-neutron":"metacritic_neutron",comicvine:"comicvine",f2:"fandom",tvguide:"tvguide",fandomdesktop:"ucp",fandommobile:"ucp",fanatical:"fanatical"}}get(){var t,e;const i=this.platform.get(),n="desktop"===this.device.getDeviceType()?"desktop":"mobile";return(null===(t=this.adsContext.get())||void 0===t?void 0:t.skin)?`${null!==(e=this.adsContext.get().skin)&&void 0!==e?e:i}_${n}`:this.skinMap[i]?this.skinMap[i]+"_"+n:"unknown"}};g=(0,s.Cg)([(0,a.Gr)(),(0,s.Qj)(0,(0,a.WQ)(h.i)),(0,s.Qj)(1,(0,a.WQ)(u.O)),(0,s.Qj)(2,(0,a.WQ)(l.p)),(0,s.Sn)("design:paramtypes",["function"==typeof(n=void 0!==h.i&&h.i)?n:Object,"function"==typeof(o=void 0!==u.O&&u.O)?o:Object,"function"==typeof(r=void 0!==l.p&&l.p)?r:Object])],g);var p=i(6167),f=i(1695),v=i(7546);let y=class{constructor(){this.operatingSystem=null}getOperatingSystem(){if(null!==this.operatingSystem)return this.operatingSystem;const{userAgent:t}=window.navigator;return this.operatingSystem="unknown",-1!==t.indexOf("Win")&&(this.operatingSystem="Windows"),-1!==t.indexOf("Mac")&&(this.operatingSystem="OSX"),-1!==t.indexOf("Linux")&&(this.operatingSystem="Linux"),-1!==t.indexOf("Android")&&(this.operatingSystem="Android"),-1!==t.indexOf("like Mac")&&(this.operatingSystem="iOS"),this.operatingSystem}};y=(0,s.Cg)([(0,a.Gr)()],y);var m,b,w,C,O,j,S,k,T,E=i(2712),Q=i(7393);let I=class{constructor(t,e,i,n,o,r,s,a,c){this.logger=t,this.httpClient=e,this.skin=i,this.optInService=n,this.window=o,this.wikiConfig=r,this.geo=s,this.browser=a,this.operatingSystem=c;const d=new Date;this.startTime=this.getTimeOrigin(),this.tzOffset=d.getTimezoneOffset()}getTimeOrigin(){var t;return null===(t=window.performance)||void 0===t?void 0:t.timeOrigin}getCurrentTimestamp(){return Date.now()}getStartTime(){return this.startTime}getTimezoneOffset(){return this.tzOffset}getTrackingParams(){var t,e,i,n,o,r,s,a,c,d,u,l,h;return{browser:`${this.operatingSystem.getOperatingSystem()} ${this.browser.getBrowser()}`,browser_ts:this.getCurrentTimestamp(),tz_offset:this.getTimezoneOffset(),country:this.geo.getCountryCode()||"",session_id:null===(e=null===(t=this.window.fandomContext)||void 0===t?void 0:t.tracking)||void 0===e?void 0:e.sessionId,pv_number:null===(n=null===(i=this.window.fandomContext)||void 0===i?void 0:i.tracking)||void 0===n?void 0:n.pvNumber,pv_number_global:null===(r=null===(o=this.window.fandomContext)||void 0===o?void 0:o.tracking)||void 0===r?void 0:r.pvNumberGlobal,pv_unique_id:null===(a=null===(s=this.window.fandomContext)||void 0===s?void 0:s.tracking)||void 0===a?void 0:a.pvUID,beacon:null===(d=null===(c=this.window.fandomContext)||void 0===c?void 0:c.tracking)||void 0===d?void 0:d.beaconId,ua:null===(u=this.window.navigator)||void 0===u?void 0:u.userAgent,c:this.wikiConfig.get("wgCityId")||"unknown",ck:this.wikiConfig.get("dsSiteKey")||"unknown",lc:this.wikiConfig.get("wgUserLanguage")||"unknown",s:this.skin.get(),u:this.optInService.trackingAllowed?this.wikiConfig.get("wgUserId")||0:-1,a:(null===(h=null===(l=this.window.fandomContext)||void 0===l?void 0:l.page)||void 0===h?void 0:h.articleId)||-1,x:this.wikiConfig.get("wgDBname")||"unknown",n:this.wikiConfig.get("wgNamespaceNumber")||-1}}getTimeBasedParams(){return{cb:Math.floor(99999*Math.random()),url:document.URL}}buildDataWarehouseUrl(t,e){if(!e)throw this.logger.error("Error building DWH tracking URL"),new Error("Error while building DWH tracking URL - no baseUrl provided");const i=new URLSearchParams(t);return i.sort(),`${e}?${i.toString()}`}sendEvent(t,e){var i;const n=this.buildDataWarehouseUrl(t,e);n&&(null===(i=this.httpClient.get(n,{mode:"cors"},5e3))||void 0===i||i.catch((t=>{this.logger.error("Failed to send data",t)})))}};I=(0,s.Cg)([(0,a._G)(),(0,s.Qj)(0,(0,a.MR)(c.V,c.O,"DataWarehouseSender")),(0,s.Qj)(1,(0,a.WQ)(d.Q)),(0,s.Qj)(2,(0,a.WQ)(g)),(0,s.Qj)(3,(0,a.WQ)(E.E)),(0,s.Qj)(4,(0,a.WQ)(Q.jf)),(0,s.Qj)(5,(0,a.WQ)(p.j)),(0,s.Qj)(6,(0,a.WQ)(f.u)),(0,s.Qj)(7,(0,a.WQ)(v.P)),(0,s.Qj)(8,(0,a.WQ)(y)),(0,s.Sn)("design:paramtypes",["function"==typeof(m=void 0!==c.V&&c.V)?m:Object,"function"==typeof(b=void 0!==d.Q&&d.Q)?b:Object,"function"==typeof(w=void 0!==g&&g)?w:Object,"function"==typeof(C=void 0!==E.E&&E.E)?C:Object,"function"==typeof(O="undefined"!=typeof Window&&Window)?O:Object,"function"==typeof(j=void 0!==p.j&&p.j)?j:Object,"function"==typeof(S=void 0!==f.u&&f.u)?S:Object,"function"==typeof(k=void 0!==v.P&&v.P)?k:Object,"function"==typeof(T=void 0!==y&&y)?T:Object])],I);var R;let _=class{constructor(t){this.sender=t}send(t){const e=Object.assign(Object.assign(Object.assign({},t),this.sender.getTimeBasedParams()),this.sender.getTrackingParams());this.sender.sendEvent(e,"https://beacon.wikia-services.com/__track/special/identityinfo")}};_=(0,s.Cg)([(0,a._G)(),(0,s.Qj)(0,(0,a.WQ)(I)),(0,s.Sn)("design:paramtypes",["function"==typeof(R=void 0!==I&&I)?R:Object])],_);var A,M=i(4489);let P=class{constructor(t){this.sender=t}send(t){const e=Object.assign(Object.assign({event_name:t,load_time:this.sender.getCurrentTimestamp()-this.sender.getStartTime()},this.sender.getTimeBasedParams()),this.sender.getTrackingParams());this.sender.sendEvent(e,"https://beacon.wikia-services.com/__track/special/adengloadtimes")}};var D;P=(0,s.Cg)([(0,a._G)(),(0,s.Qj)(0,(0,a.WQ)(I)),(0,s.Sn)("design:paramtypes",["function"==typeof(A=void 0!==I&&I)?A:Object])],P);let W=class{constructor(t){this.sender=t}send(t){const e=Object.assign(Object.assign({event_name:"chrome_label",label:t},this.sender.getTimeBasedParams()),this.sender.getTrackingParams());this.sender.sendEvent(e,"https://beacon.wikia-services.com/__track/special/chromelabels")}};var x,L,G,N;W=(0,s.Cg)([(0,a._G)(),(0,s.Qj)(0,(0,a.WQ)(I)),(0,s.Sn)("design:paramtypes",["function"==typeof(D=void 0!==I&&I)?D:Object])],W);let V=class{constructor(t,e,i,n){this.window=t,this.geo=e,this.wikiConfig=i,this.sender=n}send(t){const e=Object.assign(Object.assign({},t),this.getTrackingParams());this.sender.sendEvent(e,"https://beacon.wikia-services.com/__track/special/gdpr_events")}getTrackingParams(){var t,e,i,n;return{lang_code:this.getLanguageCode()||"unknown",detected_geo:(this.geo.getCountryCode()||"").toUpperCase(),detected_region:(this.geo.getRegionCode()||"").toUpperCase(),beacon:null===(e=null===(t=this.window.fandomContext)||void 0===t?void 0:t.tracking)||void 0===e?void 0:e.beaconId,pv_unique_id:null===(n=null===(i=this.window.fandomContext)||void 0===i?void 0:i.tracking)||void 0===n?void 0:n.pvUID}}getLanguageCode(){var t,e,i;return this.wikiConfig.get("wgUserLanguage")||(null===(i=null===(e=null===(t=this.window)||void 0===t?void 0:t.navigator)||void 0===e?void 0:e.language)||void 0===i?void 0:i.toLowerCase().substring(0,2))}};var U,F,H,$,B;V=(0,s.Cg)([(0,a._G)(),(0,s.Qj)(0,(0,a.WQ)(Q.jf)),(0,s.Qj)(1,(0,a.WQ)(f.u)),(0,s.Qj)(2,(0,a.WQ)(p.j)),(0,s.Qj)(3,(0,a.WQ)(I)),(0,s.Sn)("design:paramtypes",["function"==typeof(x="undefined"!=typeof Window&&Window)?x:Object,"function"==typeof(L=void 0!==f.u&&f.u)?L:Object,"function"==typeof(G=void 0!==p.j&&p.j)?G:Object,"function"==typeof(N=void 0!==I&&I)?N:Object])],V);let q=class{constructor(t,e,i,n,o){this.logger=t,this.identityEventSender=e,this.loadTimeEventSender=i,this.chromeLabelSender=n,this.consentEventSender=o}track(t,e){switch(t){case M.i.identity:this.identityEventSender.send(e);break;case M.i.loadTime:this.loadTimeEventSender.send(e);break;case M.i.chromeLabel:this.chromeLabelSender.send(e);break;case M.i.consents:this.consentEventSender.send(e);break;default:this.logger.info("Invalid event type to track")}}};q=(0,s.Cg)([(0,a._G)(),(0,s.Qj)(0,(0,a.MR)(c.V,c.O,"DataWarehouseService")),(0,s.Qj)(1,(0,a.WQ)(_)),(0,s.Qj)(2,(0,a.WQ)(P)),(0,s.Qj)(3,(0,a.WQ)(W)),(0,s.Qj)(4,(0,a.WQ)(V)),(0,s.Sn)("design:paramtypes",["function"==typeof(U=void 0!==c.V&&c.V)?U:Object,"function"==typeof(F=void 0!==_&&_)?F:Object,"function"==typeof(H=void 0!==P&&P)?H:Object,"function"==typeof($=void 0!==W&&W)?$:Object,"function"==typeof(B=void 0!==V&&V)?B:Object])],q)},4489:(t,e,i)=>{"use strict";var n;i.d(e,{i:()=>n}),function(t){t[t.identity=0]="identity",t[t.loadTime=1]="loadTime",t[t.chromeLabel=2]="chromeLabel",t[t.consents=3]="consents"}(n||(n={}))},6527:(t,e,i)=>{"use strict";i.d(e,{R:()=>D});var n,o,r,s,a=i(1635),c=i(1038),d=i(8569),u=i(4874),l=i(5799),h=i(3248),g=i(1695),p=i(5144),f=i(7393),v=i(2223),y=i(3905),m=i(2349),b=i(4489),w=i(3841),C=i(4085);let O=class{constructor(t,e,i,n){this.logger=t,this.dataWarehouse=e,this.communicationService=i,this.geo=n,this.ONETRUST_UI_SHOWN="onetrust-ui-shown",this.GA_CATEGORY="gdpr-modal-1t",this.eventQueue=[],this.sendImmediately=!1,this.gpcRegistered=!1,this.communicationService.once(m.c.IDENTITY_READY,(()=>{this.sendImmediately=!0,this.sendQueuedEvents()}))}init(){this.logger.info("Starting 1T tracker"),this.geo.isGdprCountry()?this.GA_CATEGORY="gdpr-modal-1t":"us"===this.geo.getCountryCode()?this.GA_CATEGORY="ccpa-modal-1t":this.logger.info("Not a GDPR or CCPA country, skipping 1T tracker",this.geo.getCountryCode())}sendActionEvent(t){this.logger.info("Queued sending action event"),this.sendEvent(t)}sendImpressionEvent(t="impression"){this.logger.info("Queued sending impression event"),this.sendEvent(t,"impression"),this.trackLoadTime()}sendGPCEvent(){this.gpcRegistered?this.logger.info("GPC event already sent"):(this.gpcRegistered=!0,this.logger.info("Queued sending GPC event"),this.sendEvent("gpc","impression"))}trackLoadTime(){this.dataWarehouse.track(b.i.loadTime,this.ONETRUST_UI_SHOWN),this.logger.info("Loading time tracking event sent")}sendEvent(t,e="click"){this.eventQueue.find((i=>i.label===t&&i.action===e))||this.eventQueue.push({label:t,action:e}),this.sendImmediately&&this.sendQueuedEvents()}sendQueuedEvents(){for(;this.eventQueue.length>0;){const t=this.eventQueue.shift(),e={ga_category:this.GA_CATEGORY,ga_action:t.action,ga_label:t.label};this.dataWarehouse.track(b.i.consents,e),this.logger.info("Action tracking event sent",t.label)}}};O=(0,a.Cg)([(0,v.Gr)(),(0,a.Qj)(0,(0,v.MR)(p.V,p.O,"OneTrustTracker")),(0,a.Qj)(1,(0,v.WQ)((0,v.cb)((()=>w.X)))),(0,a.Qj)(2,(0,v.WQ)((0,v.cb)((()=>C.U)))),(0,a.Qj)(3,(0,v.WQ)(g.u)),(0,a.Sn)("design:paramtypes",["function"==typeof(n=void 0!==p.V&&p.V)?n:Object,"function"==typeof(o=void 0!==w.X&&w.X)?o:Object,"function"==typeof(r=void 0!==C.U&&C.U)?r:Object,"function"==typeof(s=void 0!==g.u&&g.u)?s:Object])],O);var j,S,k,T,E,Q,I,R,_,A=i(5369);const M={".fanatical.com":"0ab0e172-dc9c-44b9-8a58-c80d9ba4fae0",".futhead.com":"82c642a4-d3a9-4a78-a310-21a7b49ab17b",".gamespot.com":"73588546-b116-4dbc-ab64-9db97e11fc0d",".metacritic.com":"50e16f1d-a929-4cc0-80a7-3c5c303eea6a",".muthead.com":"fb34a16e-696d-4748-af9f-96f3b9e2b4da",".tvguide.com":"ffc22311-f4da-4e03-a1ad-32aecd522c5b",".fandom.com":"dea70a1b-c82d-4fe0-86ff-5e164b0a6022"},P=[{url:"https://cdn.cookielaw.org/consent/tcf.stub.js",options:{charSet:"UTF-8"}},{url:"https://cdn.cookielaw.org/scripttemplates/otSDKStub.js",options:{}}];let D=class{constructor(t,e,i,n,o,r,s,a,d){this.cookiesManager=t,this.window=e,this.navigator=i,this.assetLoader=n,this.geo=o,this.tcfApi=r,this.logger=s,this.oneTrustTracker=a,this.sentry=d,this.trackingGroup="C0004:1",this.testMode=!!c.C.get("ot_test"),this.enableDelayedActionEvent=!1,this.initialized=!1,this.loadCCPAAddon(),this.hideDoNotSellMyInfoLink(),this.oneTrustTracker.init(),"us"===this.geo.getCountryCode()&&this.tcfApi.install(!0),this.oneTrustLoaded()||this.loadOneTrustScripts(),this.addModalListeners().catch((t=>{this.sentry.captureException(t)}))}subscribe(t){!this.oneTrustModalClosed()&&this.geo.isGdprCountry()||this.consentsUpdated(t),this.initialize(t)}oneTrustLoaded(){return!(!this.window.OneTrust&&!this.window.OneTrustStub)}hideDoNotSellMyInfoLink(){if("us"===this.geo.getCountryCode())try{this.logger.info("Hiding 'Do not sell my info' link"),document.querySelector('a[data-tracking-label="community.usp-do-not-sell"]').style.visibility="hidden"}catch(t){this.logger.error("Could not hide 'Do not sell my info' link",t)}}oneTrustModalClosed(){const t=this.cookiesManager.get("OptanonAlertBoxClosed");return t&&!!t}initialize(t){this.logger.info("Initializing OneTrust");const e=this.window.OptanonWrapper;this.window.OptanonWrapper=()=>{this.logger.info("OneTrust Wrapper Called");const i=this.oneTrustModalClosed(),n=this.geo.isGdprCountry()||"us"===this.geo.getCountryCode();if(i||!n)return this.consentsUpdated(t),null==e?void 0:e()}}getOneTrustConsentCookie(){const t=this.cookiesManager.get("OptanonConsent"),e=new URLSearchParams(t),i={};return e.forEach(((t,e)=>{i[e]=t})),this.logger.info("OneTrust cookie",i),i}oneTrustCookieExists(){return!!this.getOneTrustConsentCookie()}readTrackingConsents(){var t,e;const i=this.getOneTrustConsentCookie(),n=(null===(e=null===(t=i.groups)||void 0===t?void 0:t.split("groups=").pop())||void 0===e?void 0:e.split(";")[0])||"";return n.length&&i.groups?n.includes(this.trackingGroup):"us"===this.geo.getCountryCode()&&!this.navigator.globalPrivacyControl}consentsUpdated(t){if(this.geo.isGdprCountry()&&!this.oneTrustCookieExists())return void this.logger.info("OneTrust cookie not found");const e=this.geo.getCountryCode(),i=this.readTrackingConsents();if(this.initialized=!0,e){if("us"===e&&this.navigator.globalPrivacyControl)return this.logger.info("OneTrust GPC registered"),this.oneTrustTracker.sendGPCEvent(),void t({gdprConsent:!0,geoRequiresConsent:!1,geoRequiresSignal:!0,ccpaSignal:!0});this.handleDelayedEvent(i),t({gdprConsent:!d.e.includes(e)||i,geoRequiresConsent:d.e.includes(e),geoRequiresSignal:"us"===e,ccpaSignal:"us"===e&&!i})}}loadOneTrustScripts(){this.logger.info("Loading OneTrust scripts"),P.forEach((t=>{this.assetLoader.loadScript(t.url,"text/javascript",!0,null,Object.assign(Object.assign({},t.options),{"data-domain-script":this.getDomainId()}))}))}getDomainId(){const t=u.O.extract(this.window.location.hostname),e=M[t]||M[".fandom.com"];return this.testMode?`${e}-test`:e}loadCCPAAddon(){"us"===this.geo.getCountryCode()&&this.assetLoader.loadScript("https://cdn.cookielaw.org/opt-out/otCCPAiab.js","text/javascript",!0,null,{charSet:"UTF-8","ccpa-opt-out-geo":"us","ccpa-opt-out-ids":"C0004","ccpa-opt-out-lspa":"true","data-domain-script":this.getDomainId()})}setConsent(t){return(0,a.sH)(this,void 0,void 0,(function*(){const e=t?"1":"0";this.logger.info("Setting OneTrust consent",e),yield(0,l.f)((()=>{var t;return!!(null===(t=this.window.OneTrust)||void 0===t?void 0:t.UpdateConsent)}),50),this.window.OneTrust.UpdateConsent("Category",`C0001:${e},C0002:${e},C0003:${e},C0004:${e}`)}))}addModalListeners(){return(0,a.sH)(this,void 0,void 0,(function*(){try{yield(0,l.f)((()=>(this.logger.info("Waiting for SDK"),!!document.querySelector("#onetrust-consent-sdk"))),20,100),this.addClickListener(),this.addImpressionListener()}catch(t){throw new Error("OneTrust SDK was not initialized")}}))}addClickListener(){document.querySelector("#onetrust-consent-sdk").addEventListener("click",(t=>{switch(t.target.id){case"onetrust-accept-btn-handler":case"accept-recommended-btn-handler":return this.oneTrustTracker.sendActionEvent("accept");case"onetrust-reject-btn-handler":case"onetrust-reject-all-handler":return this.oneTrustTracker.sendActionEvent("reject");default:{const e=t.target.classList;if(e.contains("ot-pc-refuse-all-handler"))return this.oneTrustTracker.sendActionEvent("reject");if(e.contains("onetrust-close-btn-ui"))return this.oneTrustTracker.sendActionEvent("close");e.contains("save-preference-btn-handler")&&(this.initialized?(this.logger.info("OneTrust modal action is being sent"),setTimeout((()=>{this.oneTrustTracker.sendActionEvent(this.readTrackingConsents()?"accept":"reject")}))):(this.logger.info("OneTrust modal is not visible"),this.enableDelayedActionEvent=!0))}}}))}addImpressionListener(){document.querySelector(".ot-sdk-show-settings").addEventListener("click",(()=>{this.oneTrustTracker.sendImpressionEvent()}));const t=document.getElementById("onetrust-consent-sdk");document.getElementById("onetrust-banner-sdk")&&this.oneTrustTracker.sendImpressionEvent(),new MutationObserver((t=>{this.logger.info("Checking if modal is shown ",t),document.getElementById("ot-sdk-container")?(this.logger.info("OneTrust modal is visible"),this.oneTrustTracker.sendImpressionEvent()):this.logger.info("OneTrust modal is not visible")})).observe(t,{attributes:!1,childList:!1,characterData:!0})}handleDelayedEvent(t){this.logger.info("Handling delayed action event ",t),this.enableDelayedActionEvent&&(this.enableDelayedActionEvent=!1,this.oneTrustTracker.sendActionEvent(t?"accept":"reject"))}};D=(0,a.Cg)([(0,v.Gr)(),(0,a.Qj)(0,(0,v.WQ)(f.AZ)),(0,a.Qj)(1,(0,v.WQ)(f.jf)),(0,a.Qj)(2,(0,v.WQ)(f.kW)),(0,a.Qj)(3,(0,v.WQ)(h.s)),(0,a.Qj)(4,(0,v.WQ)(g.u)),(0,a.Qj)(5,(0,v.WQ)(y.q)),(0,a.Qj)(6,(0,v.MR)(p.V,p.O,"OneTrust")),(0,a.Qj)(7,(0,v.WQ)(O)),(0,a.Qj)(8,(0,v.WQ)(f.eF)),(0,a.Sn)("design:paramtypes",["function"==typeof(j="undefined"!=typeof CookiesManager&&CookiesManager)?j:Object,"function"==typeof(S="undefined"!=typeof Window&&Window)?S:Object,"function"==typeof(k="undefined"!=typeof Navigator&&Navigator)?k:Object,"function"==typeof(T=void 0!==h.s&&h.s)?T:Object,"function"==typeof(E=void 0!==g.u&&g.u)?E:Object,"function"==typeof(Q=void 0!==y.q&&y.q)?Q:Object,"function"==typeof(I=void 0!==p.V&&p.V)?I:Object,"function"==typeof(R=void 0!==O&&O)?R:Object,"function"==typeof(_=void 0!==A.t&&A.t)?_:Object])],D)},3905:(t,e,i)=>{"use strict";i.d(e,{q:()=>a});var n,o=i(1635),r=i(2223),s=i(5144);let a=class{constructor(t){this.logger=t}addLocatorFrame(){const t="____tcfapiLocator";if(window.frames[t])return;if("loading"===document.readyState)return void document.addEventListener("DOMContentLoaded",(()=>this.addLocatorFrame()));const e=document.body,i=document.createElement("iframe");i.name=t,i.style.display="none",e.appendChild(i)}install(t=!1){const e=t?28:141;function i(t){try{let e=t.data;const i="string"==typeof e;if(i)try{e=JSON.parse(e)}catch(t){}const n=e.__tcfapiCall;n&&window.__tcfapi(n.command,n.parameter,(function(e,o){const r={__tcfapiReturn:{returnValue:e,success:o,callId:n.callId}};t.source.postMessage(i?JSON.stringify(r):r,"*")}))}catch(t){}}function n(t,i,n){"addEventListener"===t||"getTCData"===t||"ping"===t?n({cmpId:e,eventStatus:"tcloaded",cmpLoaded:!0,cmpStatus:"loaded",cmpVersion:i,displayStatus:"disabled",apiVersion:"2.2",tcfPolicyVersion:4,gdprApplies:!1},!0):n(void 0,!1)}window.__tcfapi?window.__tcfapi("ping",2,(t=>{"stub"===(null==t?void 0:t.cmpStatus)&&(window.__tcfapi=n,window.__tcfapi.msgHandler=i,this.addLocatorFrame(),window.addEventListener("message",i,!1),this.logger.info("__tcfapi installed"))})):(window.__tcfapi=n,window.__tcfapi.msgHandler=i,this.addLocatorFrame(),window.addEventListener("message",i,!1),this.logger.info("__tcfapi installed"))}};a=(0,o.Cg)([(0,r.Gr)(),(0,o.Qj)(0,(0,r.MR)(s.V,s.O,"TCF")),(0,o.Sn)("design:paramtypes",["function"==typeof(n=void 0!==s.V&&s.V)?n:Object])],a)},2517:(t,e,i)=>{"use strict";i.d(e,{h:()=>h,u:()=>s});var n,o,r,s,a=i(1635),c=i(2223),d=i(7393),u=i(4874),l=i(5144);!function(t){t.yes="Y",t.no="N",t.na="-"}(s||(s={}));let h=class{constructor(t,e,i){this.cookiesManager=t,this.window=e,this.logger=i,this.usPrivacyCookie="usprivacy",this.USP_API_VERSION=1,this.CCPA_TRACKING_ALLOWED="1YN",this.queue=[],this.explicitNotice=s.yes,this.lspaSupport=s.no}isUspApiAvailable(){return void 0!==this.window.__uspapi}installUspApi(){this.window.__uspapi=this.uspApiMessage.bind(this),this.addLocatorFrame(),this.addUspMessageListener(),this.logger.info("__uspapi installed")}getPrivacyStringCookie(){return this.cookiesManager.get(this.usPrivacyCookie)}createPrivacyCookie(t=s.na){const e=this.window.location.hostname,i=u.O.extract(e),n=t===s.na?`${this.USP_API_VERSION}${s.na}${s.na}${s.na}`:`${this.USP_API_VERSION}${this.explicitNotice}${t}${this.lspaSupport}`;this.cookiesManager.set(this.usPrivacyCookie,n,{domain:i,expires:365})}consentsUpdated(t){return{gdprConsent:!0,geoRequiresConsent:!1,geoRequiresSignal:!0,ccpaSignal:!t.startsWith(this.CCPA_TRACKING_ALLOWED)}}uspApiMessage(t,e,i){"ping"===t?i({uspapiLoaded:!1},!0):"getUSPData"===t?i({version:this.USP_API_VERSION,uspString:this.getPrivacyStringCookie()},!0):"getQueue"===t?i(this.queue,!0):this.queue.push([t,e,i])}addLocatorFrame(){const t="__uspapi";if(this.window.frames[t])return;if("loading"===document.readyState)return void document.addEventListener("DOMContentLoaded",(()=>this.addLocatorFrame()));const e=document.createElement("iframe");e.name=t,e.style.display="none",document.body.appendChild(e)}addUspMessageListener(){this.window.addEventListener("message",(t=>{const e=this.convertUspMessageData(t);e&&this.uspMessageHandler(e,t)}),!1)}convertUspMessageData(t){try{return("string"==typeof t.data?JSON.parse(t.data):t.data).__uspapiCall}catch(t){}}uspMessageHandler(t,e){this.window.__uspapi(t.command,t.version,((i,n)=>{const o={__uspapiReturn:{returnValue:i,success:n,callId:t.callId}};e.source.postMessage(o,"*")}))}subscribe(t){this.window.__uspapi&&this.window.__uspapi("getUSPData",this.USP_API_VERSION,(e=>{(null==e?void 0:e.uspString)&&t(this.consentsUpdated(e.uspString))}))}};h=(0,a.Cg)([(0,c.Gr)(),(0,a.Qj)(0,(0,c.WQ)(d.AZ)),(0,a.Qj)(1,(0,c.WQ)(d.jf)),(0,a.Qj)(2,(0,c.MR)(l.V,l.O,"USP")),(0,a.Sn)("design:paramtypes",["function"==typeof(n="undefined"!=typeof CookiesManager&&CookiesManager)?n:Object,"function"==typeof(o="undefined"!=typeof Window&&Window)?o:Object,"function"==typeof(r=void 0!==l.V&&l.V)?r:Object])],h)},2712:(t,e,i)=>{"use strict";i.d(e,{E:()=>E});var n,o,r,s=i(1635),a=i(5144),c=i(2223),d=i(3155),u=i(2349),l=i(4085),h=i(2439),g=i(8569),p=i(1695),f=i(2517),v=i(3905);let y=class{constructor(t,e,i){this.logger=t,this.uspApi=e,this.tcfApi=i,this.tcfApi.install()}subscribe(t){this.logger.info("__uspapi installed"),this.uspApi.subscribe(t)}};y=(0,s.Cg)([(0,c.Gr)(),(0,s.Qj)(0,(0,c.MR)(a.V,a.O,"OptInService")),(0,s.Qj)(1,(0,c.WQ)(f.h)),(0,s.Qj)(2,(0,c.WQ)(v.q)),(0,s.Sn)("design:paramtypes",["function"==typeof(n=void 0!==a.V&&a.V)?n:Object,"function"==typeof(o=void 0!==f.h&&f.h)?o:Object,"function"==typeof(r=void 0!==v.q&&v.q)?r:Object])],y);var m,b,w,C,O=i(7393);let j=class{constructor(t,e,i,n){this.window=t,this.geo=e,this.platform=i,this.logger=n,this.ONE_TRUST_PLATFORMS=[h.l.GIANTBOMB,h.l.TVGUIDE,h.l.TVGUIDE_MTC,h.l.METACRITIC_NEUTRON,h.l.METACRITIC,h.l.GAMESPOT,h.l.COMICVINE,h.l.GAMEFAQS]}shouldLoadOneTrust(){return this.ONE_TRUST_PLATFORMS.includes(this.platform.get())}get(t=!1){if(this.shouldLoadOneTrust()||t){if(void 0===this.window.trackingOptIn||void 0===this.window.trackingOptInInstances)return i.e(832).then(i.bind(i,4529)).then((({OneTrustConsentStrategy:t})=>c.kL.resolve(t)));this.logger.warn("OneTrust should be loaded, but TrackingOptIn is present. Skipping OneTrust.")}if("fanatical"===this.platform.get())return i.e(482).then(i.bind(i,7341)).then((({FanaticalConsentStrategy:t})=>c.kL.resolve(t)));const e=this.geo.getCountryCode();if(e){if("us"===e)return Promise.resolve(c.kL.resolve(y));if(g.e.includes(e))return i.e(224).then(i.bind(i,8875)).then((({FandomGdprConsentStrategy:t})=>c.kL.resolve(t)))}return i.e(319).then(i.bind(i,3322)).then((({StaticConsentStrategy:t})=>c.kL.resolve(t)))}};var S,k,T;j=(0,s.Cg)([(0,c.Gr)(),(0,s.Qj)(0,(0,c.WQ)(O.jf)),(0,s.Qj)(1,(0,c.WQ)(p.u)),(0,s.Qj)(2,(0,c.WQ)(h.O)),(0,s.Qj)(3,(0,c.MR)(a.V,a.O,"OptInService")),(0,s.Sn)("design:paramtypes",["function"==typeof(m="undefined"!=typeof Window&&Window)?m:Object,"function"==typeof(b=void 0!==p.u&&p.u)?b:Object,"function"==typeof(w=void 0!==h.O&&h.O)?w:Object,"function"==typeof(C=void 0!==a.V&&a.V)?C:Object])],j);let E=class{get trackingAllowed(){return this._trackingAllowed}set trackingAllowed(t){this._trackingAllowed=t}constructor(t,e,i){this.communicationService=t,this.logger=e,this.consentProviderFactory=i,this.consentUpdated=!1,this._trackingAllowed=!1}init(t){const e=t.get("icFandom1TEnabled",!1);this.consentProviderFactory.get(e).then((t=>t.subscribe((t=>{this.logger.info("Sending consents: ",t,"update?",this.consentUpdated),this.consentUpdated&&this.sendConsentsUpdateToAdEngine(t),this.sendConsentsToAdEngine(t),this.consentUpdated||(this.consentUpdated=!0)}))))}sendConsentsToAdEngine(t){this.communicationService.emit(new d.r(u.c.CONSENT_READY,t))}sendConsentsUpdateToAdEngine(t){this.communicationService.emit(new d.r(u.c.CONSENT_UPDATE,t))}};E=(0,s.Cg)([(0,c.Gr)(),(0,s.Qj)(0,(0,c.WQ)(l.U)),(0,s.Qj)(1,(0,c.MR)(a.V,a.O,"OptInService")),(0,s.Qj)(2,(0,c.WQ)(j)),(0,s.Sn)("design:paramtypes",["function"==typeof(S=void 0!==l.U&&l.U)?S:Object,"function"==typeof(k=void 0!==a.V&&a.V)?k:Object,"function"==typeof(T=void 0!==j&&j)?T:Object])],E)},7393:(t,e,i)=>{"use strict";i.d(e,{AZ:()=>n,LT:()=>c,eF:()=>a,jf:()=>r,kW:()=>o,kk:()=>s});const n=Symbol("COOKIES"),o=Symbol("NAVIGATOR"),r=Symbol("WINDOW"),s=Symbol("UUID"),a=Symbol("SENTRY"),c=Symbol("NEW_RELIC")},6610:(t,e,i)=>{"use strict";i.d(e,{i:()=>a});var n,o=i(1635),r=i(2223),s=i(7393);let a=class{constructor(t){this.window=t}get(){var t;return null===(t=this.window.ads)||void 0===t?void 0:t.context}};a=(0,o.Cg)([(0,r._G)(),(0,o.Qj)(0,(0,r.WQ)(s.jf)),(0,o.Sn)("design:paramtypes",["function"==typeof(n="undefined"!=typeof Window&&Window)?n:Object])],a)},3248:(t,e,i)=>{"use strict";i.d(e,{s:()=>r});var n=i(1635),o=i(2223);let r=class{constructor(){this.loadedAssets=[]}createScript(t,e="text/javascript",i=!0,n=null,o={},r={}){const s=document.createElement("script");if(s.async=i,s.defer=!i,s.type=e,s.src=t,Object.keys(o).forEach((t=>{s.setAttribute(t,o[t])})),Object.keys(r).forEach((t=>{s.dataset[t]=r[t]})),"string"==typeof n){const t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(s,t)}else(n||document.body).append(s);return s}loadScript(t,e="text/javascript",i=!0,n=null,o={},r={}){return new Promise(((s,a)=>{if(this.loadedAssets.includes(t))return s(null);const c=this.createScript(t,e,i,n,o,r);c.onload=s,c.onerror=a})).then((e=>(this.loadedAssets.push(t),e)))}};r=(0,n.Cg)([(0,o._G)()],r)},7546:(t,e,i)=>{"use strict";i.d(e,{P:()=>r});var n=i(1635),o=i(2223);let r=class{recognizeChromiumBuild(t,e){const i=e.match(/\b(OPR|Edg)\/(\d+)/);return null!==i?i.slice(1).join(" ").replace("OPR","Opera").replace("Edg","Edge"):"Chrome "+t}recognizeIEBuild(t){return`IE ${(/\brv[ :]+(\d+)/g.exec(t)||[""])[1]||""}`}getBrowserNameAndVersion(t){const[,e,i]=t.match(/(opera|chrome|safari|firefox|msie|trident|CriOS(?=\/))\/?\s*(\d+)/i)||[];return[e,i]}recognizeDefaultBrowser(t,e,i,n,o){const r=o?[n,o]:[e,i,"-?"],s=t.match(/version\/(\d+)/i);return null!==s&&r.splice(1,1,s[1]),r.join(" ")}getBrowser(){const{appName:t,appVersion:e,userAgent:i}=window.navigator,[n,o]=this.getBrowserNameAndVersion(i);return/trident/i.test(n)?this.recognizeIEBuild(i):"Chrome"===n||"CriOS"===n?this.recognizeChromiumBuild(o,i):this.recognizeDefaultBrowser(i,t,e,n,o)}};r=(0,n.Cg)([(0,o.Gr)()],r)},8569:(t,e,i)=>{"use strict";i.d(e,{e:()=>n});const n=["ai","aw","ax","at","be","bg","bm","vg","bq","ky","hr","cw","cy","cz","dk","ee","fk","fo","fi","fr","gf","pf","tf","de","gi","gr","gl","gp","hu","is","ie","im","it","re","lv","li","lt","lu","mq","mt","yt","ms","nl","nc","no","pn","pl","pt","ro","bl","sh","mf","pm","bq","sx","sk","si","es","se","ch","tc","gb","uk","wf","ad","br","cn"]},3710:(t,e,i)=>{"use strict";i.d(e,{p:()=>d});var n,o,r=i(1635),s=i(2223),a=i(7393),c=i(2439);let d=class{constructor(t,e){this.platform=e,this.testRegex=/Mobi|Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i,this.userAgent=t.userAgent}getDeviceType(){const t=this.platform.get();return t===c.l.FANDOMDESKTOP?"desktop":t===c.l.FANDOMMOBILE||this.testRegex.test(this.userAgent)?"smartphone":"desktop"}};d=(0,r.Cg)([(0,s.Gr)(),(0,r.Qj)(0,(0,s.WQ)(a.kW)),(0,r.Qj)(1,(0,s.WQ)(c.O)),(0,r.Sn)("design:paramtypes",["function"==typeof(n="undefined"!=typeof Navigator&&Navigator)?n:Object,"function"==typeof(o=void 0!==c.O&&c.O)?o:Object])],d)},1695:(t,e,i)=>{"use strict";i.d(e,{u:()=>u});var n,o,r=i(1635),s=i(2223),a=i(7393),c=i(8569);class d extends Error{constructor(t){super(t),this.name="GeoJsonParseException"}}let u=class{constructor(t,e){this.cookiesManager=t,this.window=e}get(){return this.geoData||(this.geoData=this.getGeoData()),this.geoData}set(t){this.geoData=t}getGeoData(){var t;if(void 0!==(null===(t=this.window.ads)||void 0===t?void 0:t.geo))return this.window.ads.geo;const e=this.getGeoDataFromCookie();return Object.keys(e).length?e:this.getGeoDataFromOneTrust()}getGeoDataFromCookie(){const t=this.cookiesManager.get("Geo");if(!t)return{};const e=decodeURIComponent(t);try{return JSON.parse(e)}catch(t){throw new d(`Failed to parse Geo cookie: ${t}`)}}getGeoDataFromOneTrust(){return this.window.OneTrust&&this.window.OneTrust.getGeolocationData()?{country:this.window.OneTrust.getGeolocationData().country}:{}}getCountryCode(){var t,e;return null===(e=null===(t=this.get())||void 0===t?void 0:t.country)||void 0===e?void 0:e.toLowerCase()}getRegionCode(){var t,e;return null===(e=null===(t=this.get())||void 0===t?void 0:t.region)||void 0===e?void 0:e.toLowerCase()}getContinentCode(){var t,e;return null===(e=null===(t=this.get())||void 0===t?void 0:t.continent)||void 0===e?void 0:e.toLowerCase()}isGdprCountry(){return c.e.includes(this.getCountryCode())}};u=(0,r.Cg)([(0,s.Gr)(),(0,r.Qj)(0,(0,s.WQ)(a.AZ)),(0,r.Qj)(1,(0,s.WQ)(a.jf)),(0,r.Sn)("design:paramtypes",["function"==typeof(n="undefined"!=typeof CookiesManager&&CookiesManager)?n:Object,"function"==typeof(o="undefined"!=typeof Window&&Window)?o:Object])],u)},3858:(t,e,i)=>{"use strict";i.d(e,{Q:()=>a,j:()=>s});var n,o=i(1635),r=i(2223);class s extends Error{constructor(t){super(t),this.name=this.constructor.name}}let a=n=class{get(t){return(0,o.sH)(this,arguments,void 0,(function*(t,e={mode:"cors"},i=n.DEFAULT_TIMEOUT){return this.fetch(t,"GET",e,i)}))}put(t,e){return(0,o.sH)(this,arguments,void 0,(function*(t,e,i={mode:"cors"}){return this.fetch(t,"PUT",i,0,e)}))}fetch(t,e){return(0,o.sH)(this,arguments,void 0,(function*(t,e,i={mode:"cors"},n=0,o){let r,a;if(n>0){const t=new AbortController;a=setTimeout((()=>t.abort()),n),r=t.signal}try{const n=yield fetch(t,Object.assign({method:e,signal:r,headers:o?{"Content-Type":"application/json"}:void 0,body:o?JSON.stringify(o):void 0},i));if(void 0!==a&&clearTimeout(a),!n.ok)throw new s(`HTTP error ${t}! Status: ${n.status}`);return n}catch(e){if(e instanceof s)throw e;throw new s(`HTTP error ${e} while sending request to ${t}!`)}}))}};a.DEFAULT_TIMEOUT=1e3,a=n=(0,o.Cg)([(0,r._G)()],a)},8978:(t,e,i)=>{"use strict";i.d(e,{A:()=>o});var n=i(1038);function o(){return"1"===n.C.get("identity_debug")}},5144:(t,e,i)=>{"use strict";i.d(e,{O:()=>d,V:()=>u});var n,o=i(1635),r=i(1038),s=i(2223),a=i(7393),c=i(8978);class d{transform(t,e){return t.setLoggerGroup(e)}}let u=class{constructor(t){var e,i;this.logGroup="Global",this.debugGroup=this.getDebugGroup()||"",this.groups=this.debugGroup.split(","),this.initTime=null!==(i=null===(e=null==t?void 0:t.performance)||void 0===e?void 0:e.timeOrigin)&&void 0!==i?i:Date.now()}setLoggerGroup(t){return this.logGroup=t,this}getTimeDelta(){return Date.now()-this.initTime}getDebugGroup(){return r.C.get("identity_debug")}getTimeDeltaFixed(){return(this.getTimeDelta()/1e3).toFixed(4)}info(...t){this.loggingEnabled()&&console.info(`${this.getTimeDeltaFixed()}s\t\t [IE] ${this.logGroup}`,t)}warn(...t){this.loggingEnabled()&&console.warn(`${this.getTimeDeltaFixed()}s\t\t [IE] ${this.logGroup}`,t)}error(...t){this.loggingEnabled()&&console.error(`${this.getTimeDeltaFixed()}s\t\t [IE] ${this.logGroup}`,t)}loggingEnabled(){return(0,c.A)()||-1!==this.groups.indexOf(this.logGroup)}};u=(0,o.Cg)([(0,s._G)(),(0,o.Qj)(0,(0,s.WQ)(a.jf)),(0,o.Sn)("design:paramtypes",["function"==typeof(n="undefined"!=typeof Window&&Window)?n:Object])],u)},2439:(t,e,i)=>{"use strict";i.d(e,{O:()=>c,l:()=>o});var n,o,r=i(1635),s=i(2223),a=i(6610);!function(t){t.F2="f2",t.FUTHEAD="futhead",t.MUTHEAD="muthead",t.GAMESPOT="gamespot",t.COMICVINE="comicvine",t.GAMEFAQS="gamefaqs",t.METACRITIC="metacritic",t.METACRITIC_NEUTRON="metacritic-neutron",t.TVGUIDE="tvguide",t.TVGUIDE_MTC="tvguide-mtc",t.GIANTBOMB="giantbomb",t.FANATICAL="fanatical",t.FANDOMDESKTOP="fandomdesktop",t.FANDOMMOBILE="fandommobile"}(o||(o={}));let c=class{constructor(t){this.adsContext=t}get(){var t;const e=this.adsContext.get();return(null!==(t=null==e?void 0:e.platform)&&void 0!==t?t:null==e?void 0:e.app)||this.detectPlatform()}detectPlatform(){var t,e,i;return void 0!==window.mw&&void 0!==(null===(i=null===(e=null===(t=window.ads)||void 0===t?void 0:t.context)||void 0===e?void 0:e.opts)||void 0===i?void 0:i.platformName)?window.ads.context.opts.platformName:this.checkHostname()}checkHostname(){const{hostname:t,pathname:e}=window.location;switch(!0){case t.includes("fandom"):return o.F2;case t.includes("futhead"):return o.FUTHEAD;case t.includes("muthead"):return o.MUTHEAD;case t.includes("gamespot"):return t.includes("comicvine")?o.COMICVINE:t.includes("gamefaqs")?o.GAMEFAQS:o.GAMESPOT;case t.includes("metacritic"):return e.includes("news")?o.METACRITIC_NEUTRON:o.METACRITIC;case t.includes("tvguide"):return o.TVGUIDE;case t.includes("giantbomb"):return o.GIANTBOMB;case t.includes("fanatical"):return o.FANATICAL;default:return o.FANDOMDESKTOP}}};c=(0,r.Cg)([(0,s.Gr)(),(0,r.Qj)(0,(0,s.WQ)(a.i)),(0,r.Sn)("design:paramtypes",["function"==typeof(n=void 0!==a.i&&a.i)?n:Object])],c)},1038:(t,e,i)=>{"use strict";i.d(e,{C:()=>n});class n{static getURLSearchParams(){const t=window.location.search.substring(1);return new URLSearchParams(t)}static get(t){return n.getURLSearchParams().get(t)}static stringify(t){const e=new URLSearchParams(t);return e.sort(),e.toString()}}},4874:(t,e,i)=>{"use strict";i.d(e,{O:()=>r});var n=i(1635),o=i(2223);let r=class{static extract(t){const e=t.split(".");if(e.length<2)return t;let i=`.${e[e.length-2]}.${e[e.length-1]}`;return[".co.jp",".co.nz",".co.uk"].indexOf(i)>=0&&(i=`.${e[e.length-3]}${i}`),i}};r=(0,n.Cg)([(0,o._G)()],r)},5799:(t,e,i)=>{"use strict";function n(t,e=10,i=50){return new Promise(((n,o)=>{let r=0;const s=setInterval((()=>{t()&&(clearInterval(s),n()),r++>e&&(clearInterval(s),o())}),i)}))}i.d(e,{f:()=>n})},6167:(t,e,i)=>{"use strict";i.d(e,{j:()=>a});var n,o=i(1635),r=i(2223),s=i(7393);let a=class{constructor(t){this.window=t}get(t,e=null){var i,n,o;return null!==(o=null===(n=null===(i=this.window.mw)||void 0===i?void 0:i.config)||void 0===n?void 0:n.get(t))&&void 0!==o?o:e}};a=(0,o.Cg)([(0,r.Gr)(),(0,o.Qj)(0,(0,r.WQ)(s.jf)),(0,o.Sn)("design:paramtypes",["function"==typeof(n="undefined"!=typeof Window&&Window)?n:Object])],a)},2223:(t,e,i)=>{"use strict";var n;i.d(e,{kL:()=>T,cb:()=>g,WQ:()=>I,MR:()=>A,_G:()=>R,Gr:()=>_}),function(t){t[t.Transient=0]="Transient",t[t.Singleton=1]="Singleton",t[t.ResolutionScoped=2]="ResolutionScoped",t[t.ContainerScoped=3]="ContainerScoped"}(n||(n={}));const o=n;var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},r(t,e)};function s(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}function a(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],n=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,o,r=i.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=r.next()).done;)s.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(o)throw o.error}}return s}function d(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(c(arguments[e]));return t}function u(t){return!!t.useClass}function l(t){return!!t.useFactory}var h=function(){function t(t){this.wrap=t,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct","ownKeys"]}return t.prototype.createProxy=function(t){var e,i=this,n=!1;return new Proxy({},this.createHandler((function(){return n||(e=t(i.wrap()),n=!0),e})))},t.prototype.createHandler=function(t){var e={};return this.reflectMethods.forEach((function(i){e[i]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return e[0]=t(),Reflect[i].apply(void 0,d(e))}})),e},t}();function g(t){if(void 0===t)throw new Error("Attempt to `delay` undefined. Constructor must be wrapped in a callback");return new h(t)}function p(t){return"string"==typeof t||"symbol"==typeof t}function f(t){return"object"==typeof t&&"token"in t&&"transform"in t}function v(t){return!!t.useToken}function y(t){return null!=t.useValue}const m=function(){function t(){this._registryMap=new Map}return t.prototype.entries=function(){return this._registryMap.entries()},t.prototype.getAll=function(t){return this.ensure(t),this._registryMap.get(t)},t.prototype.get=function(t){this.ensure(t);var e=this._registryMap.get(t);return e[e.length-1]||null},t.prototype.set=function(t,e){this.ensure(t),this._registryMap.get(t).push(e)},t.prototype.setAll=function(t,e){this._registryMap.set(t,e)},t.prototype.has=function(t){return this.ensure(t),this._registryMap.get(t).length>0},t.prototype.clear=function(){this._registryMap.clear()},t.prototype.ensure=function(t){this._registryMap.has(t)||this._registryMap.set(t,[])},t}(),b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(m),w=function(){this.scopedResolutions=new Map};var C=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(m),O=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(m);const j=function(){this.preResolution=new C,this.postResolution=new O};var S=new Map,k=function(){function t(t){this.parent=t,this._registry=new b,this.interceptors=new j,this.disposed=!1,this.disposables=new Set}return t.prototype.register=function(t,e,i){var n;if(void 0===i&&(i={lifecycle:o.Transient}),this.ensureNotDisposed(),n=function(t){return u(t)||y(t)||v(t)||l(t)}(e)?e:{useClass:e},v(n))for(var r=[t],s=n;null!=s;){var a=s.useToken;if(r.includes(a))throw new Error("Token registration cycle detected! "+d(r,[a]).join(" -> "));r.push(a);var c=this._registry.get(a);s=c&&v(c.provider)?c.provider:null}if((i.lifecycle===o.Singleton||i.lifecycle==o.ContainerScoped||i.lifecycle==o.ResolutionScoped)&&(y(n)||l(n)))throw new Error('Cannot use lifecycle "'+o[i.lifecycle]+'" with ValueProviders or FactoryProviders');return this._registry.set(t,{provider:n,options:i}),this},t.prototype.registerType=function(t,e){return this.ensureNotDisposed(),p(e)?this.register(t,{useToken:e}):this.register(t,{useClass:e})},t.prototype.registerInstance=function(t,e){return this.ensureNotDisposed(),this.register(t,{useValue:e})},t.prototype.registerSingleton=function(t,e){if(this.ensureNotDisposed(),p(t)){if(p(e))return this.register(t,{useToken:e},{lifecycle:o.Singleton});if(e)return this.register(t,{useClass:e},{lifecycle:o.Singleton});throw new Error('Cannot register a type name as a singleton without a "to" token')}var i=t;return e&&!p(e)&&(i=e),this.register(t,{useClass:i},{lifecycle:o.Singleton})},t.prototype.resolve=function(t,e){void 0===e&&(e=new w),this.ensureNotDisposed();var i=this.getRegistration(t);if(!i&&p(t))throw new Error('Attempted to resolve unregistered dependency token: "'+t.toString()+'"');if(this.executePreResolutionInterceptor(t,"Single"),i){var n=this.resolveRegistration(i,e);return this.executePostResolutionInterceptor(t,n,"Single"),n}if(function(t){return"function"==typeof t||t instanceof h}(t))return n=this.construct(t,e),this.executePostResolutionInterceptor(t,n,"Single"),n;throw new Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")},t.prototype.executePreResolutionInterceptor=function(t,e){var i,n;if(this.interceptors.preResolution.has(t)){var o=[];try{for(var r=a(this.interceptors.preResolution.getAll(t)),s=r.next();!s.done;s=r.next()){var c=s.value;"Once"!=c.options.frequency&&o.push(c),c.callback(t,e)}}catch(t){i={error:t}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}this.interceptors.preResolution.setAll(t,o)}},t.prototype.executePostResolutionInterceptor=function(t,e,i){var n,o;if(this.interceptors.postResolution.has(t)){var r=[];try{for(var s=a(this.interceptors.postResolution.getAll(t)),c=s.next();!c.done;c=s.next()){var d=c.value;"Once"!=d.options.frequency&&r.push(d),d.callback(t,e,i)}}catch(t){n={error:t}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}this.interceptors.postResolution.setAll(t,r)}},t.prototype.resolveRegistration=function(t,e){if(this.ensureNotDisposed(),t.options.lifecycle===o.ResolutionScoped&&e.scopedResolutions.has(t))return e.scopedResolutions.get(t);var i,n=t.options.lifecycle===o.Singleton,r=t.options.lifecycle===o.ContainerScoped,s=n||r;return i=y(t.provider)?t.provider.useValue:v(t.provider)?s?t.instance||(t.instance=this.resolve(t.provider.useToken,e)):this.resolve(t.provider.useToken,e):u(t.provider)?s?t.instance||(t.instance=this.construct(t.provider.useClass,e)):this.construct(t.provider.useClass,e):l(t.provider)?t.provider.useFactory(this):this.construct(t.provider,e),t.options.lifecycle===o.ResolutionScoped&&e.scopedResolutions.set(t,i),i},t.prototype.resolveAll=function(t,e){var i=this;void 0===e&&(e=new w),this.ensureNotDisposed();var n=this.getAllRegistrations(t);if(!n&&p(t))throw new Error('Attempted to resolve unregistered dependency token: "'+t.toString()+'"');if(this.executePreResolutionInterceptor(t,"All"),n){var o=n.map((function(t){return i.resolveRegistration(t,e)}));return this.executePostResolutionInterceptor(t,o,"All"),o}var r=[this.construct(t,e)];return this.executePostResolutionInterceptor(t,r,"All"),r},t.prototype.isRegistered=function(t,e){return void 0===e&&(e=!1),this.ensureNotDisposed(),this._registry.has(t)||e&&(this.parent||!1)&&this.parent.isRegistered(t,!0)},t.prototype.reset=function(){this.ensureNotDisposed(),this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()},t.prototype.clearInstances=function(){var t,e;this.ensureNotDisposed();try{for(var i=a(this._registry.entries()),n=i.next();!n.done;n=i.next()){var o=c(n.value,2),r=o[0],s=o[1];this._registry.setAll(r,s.filter((function(t){return!y(t.provider)})).map((function(t){return t.instance=void 0,t})))}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},t.prototype.createChildContainer=function(){var e,i;this.ensureNotDisposed();var n=new t(this);try{for(var r=a(this._registry.entries()),s=r.next();!s.done;s=r.next()){var d=c(s.value,2),u=d[0],l=d[1];l.some((function(t){return t.options.lifecycle===o.ContainerScoped}))&&n._registry.setAll(u,l.map((function(t){return t.options.lifecycle===o.ContainerScoped?{provider:t.provider,options:t.options}:t})))}}catch(t){e={error:t}}finally{try{s&&!s.done&&(i=r.return)&&i.call(r)}finally{if(e)throw e.error}}return n},t.prototype.beforeResolution=function(t,e,i){void 0===i&&(i={frequency:"Always"}),this.interceptors.preResolution.set(t,{callback:e,options:i})},t.prototype.afterResolution=function(t,e,i){void 0===i&&(i={frequency:"Always"}),this.interceptors.postResolution.set(t,{callback:e,options:i})},t.prototype.dispose=function(){return t=this,e=void 0,n=function(){var t;return function(t,e){var i,n,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}}(this,(function(e){switch(e.label){case 0:return this.disposed=!0,t=[],this.disposables.forEach((function(e){var i=e.dispose();i&&t.push(i)})),[4,Promise.all(t)];case 1:return e.sent(),[2]}}))},new((i=void 0)||(i=Promise))((function(o,r){function s(t){try{c(n.next(t))}catch(t){r(t)}}function a(t){try{c(n.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}c((n=n.apply(t,e||[])).next())}));var t,e,i,n},t.prototype.getRegistration=function(t){return this.isRegistered(t)?this._registry.get(t):this.parent?this.parent.getRegistration(t):null},t.prototype.getAllRegistrations=function(t){return this.isRegistered(t)?this._registry.getAll(t):this.parent?this.parent.getAllRegistrations(t):null},t.prototype.construct=function(t,e){var i=this;if(t instanceof h)return t.createProxy((function(t){return i.resolve(t,e)}));var n,o=function(){var n=S.get(t);if(!n||0===n.length){if(0===t.length)return new t;throw new Error('TypeInfo not known for "'+t.name+'"')}var o=n.map(i.resolveParams(e,t));return new(t.bind.apply(t,d([void 0],o)))}();return"function"!=typeof(n=o).dispose||n.dispose.length>0||this.disposables.add(o),o},t.prototype.resolveParams=function(t,e){var i=this;return function(n,o){var r,s,a,u;try{return"object"==typeof(u=n)&&"token"in u&&"multiple"in u?f(n)?n.multiple?(r=i.resolve(n.transform)).transform.apply(r,d([i.resolveAll(n.token)],n.transformArgs)):(s=i.resolve(n.transform)).transform.apply(s,d([i.resolve(n.token,t)],n.transformArgs)):n.multiple?i.resolveAll(n.token):i.resolve(n.token,t):f(n)?(a=i.resolve(n.transform,t)).transform.apply(a,d([i.resolve(n.token,t)],n.transformArgs)):i.resolve(n,t)}catch(t){throw new Error(function(t,e,i){var n,o,r,s,a=c(t.toString().match(/constructor\(([\w, ]+)\)/)||[],2)[1];return n="Cannot inject the dependency "+(s=e,(null===(r=void 0===a?null:a)?"at position #"+s:'"'+r.split(",")[s].trim()+'" at position #'+s)+' of "')+t.name+'" constructor. Reason:',void 0===o&&(o="    "),d([n],i.message.split("\n").map((function(t){return o+t}))).join("\n")}(e,o,t))}}},t.prototype.ensureNotDisposed=function(){if(this.disposed)throw new Error("This container has been disposed, you cannot interact with a disposed container")},t}(),T=new k,E="injectionTokens";function Q(t,e){return function(i,n,o){var r=Reflect.getOwnMetadata(E,i)||{};r[o]=e?{token:t,transform:e.transformToken,transformArgs:e.args||[]}:t,Reflect.defineMetadata(E,r,i)}}const I=function(t){return Q(t)},R=function(){return function(t){S.set(t,function(t){var e=Reflect.getMetadata("design:paramtypes",t)||[],i=Reflect.getOwnMetadata(E,t)||{};return Object.keys(i).forEach((function(t){e[+t]=i[t]})),e}(t))}},_=function(){return function(t){R()(t),T.registerSingleton(t)}},A=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];return Q(t,{transformToken:e,args:i})};if("undefined"==typeof Reflect||!Reflect.getMetadata)throw new Error("tsyringe requires a reflect polyfill. Please add 'import \"reflect-metadata\"' to the top of your entry point.")},698:(t,e,i)=>{var n;!function(t){!function(e){var n="object"==typeof globalThis?globalThis:"object"==typeof i.g?i.g:"object"==typeof self?self:"object"==typeof this?this:function(){throw new ReferenceError("globalThis could not be found. Please polyfill globalThis before loading this module.")}(),o=r(t);function r(t,e){return function(i,n){Object.defineProperty(t,i,{configurable:!0,writable:!0,value:n}),e&&e(i,n)}}void 0!==n.Reflect&&(o=r(n.Reflect,o)),function(t,e){var i="function"==typeof Symbol,n=i&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:D("Symbol.toPrimitive not found."),o=i&&void 0!==Symbol.iterator?Symbol.iterator:D("Symbol.iterator not found."),r=Object.getPrototypeOf(Function),s="function"==typeof Map&&"function"==typeof Map.prototype.entries?Map:D("A valid Map constructor could not be found."),a="function"==typeof Set&&"function"==typeof Set.prototype.entries?Set:D("A valid Set constructor could not be found."),c="function"==typeof WeakMap?WeakMap:D("A valid WeakMap constructor could not be found."),d=i?Symbol.for("@reflect-metadata:registry"):void 0,u=function(){var t;return!w(d)&&O(e.Reflect)&&Object.isExtensible(e.Reflect)&&(t=e.Reflect[d]),w(t)&&(t=function(){var t,i,n,o;w(d)||void 0===e.Reflect||d in e.Reflect||"function"!=typeof e.Reflect.defineMetadata||(t=function(t){var e=t.defineMetadata,i=t.hasOwnMetadata,n=t.getOwnMetadata,o=t.getOwnMetadataKeys,r=t.deleteMetadata,s=new c;return{isProviderFor:function(t,e){var i=s.get(t);return!(w(i)||!i.has(e))||!!o(t,e).length&&(w(i)&&(i=new a,s.set(t,i)),i.add(e),!0)},OrdinaryDefineOwnMetadata:e,OrdinaryHasOwnMetadata:i,OrdinaryGetOwnMetadata:n,OrdinaryOwnMetadataKeys:o,OrdinaryDeleteMetadata:r}}(e.Reflect));var r=new c,u={registerProvider:l,getProvider:g,setProvider:f};return u;function l(e){if(!Object.isExtensible(u))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case t===e:break;case w(i):i=e;break;case i===e:break;case w(n):n=e;break;case n===e:break;default:void 0===o&&(o=new a),o.add(e)}}function h(e,r){if(!w(i)){if(i.isProviderFor(e,r))return i;if(!w(n)){if(n.isProviderFor(e,r))return i;if(!w(o))for(var s=R(o);;){var a=A(s);if(!a)return;var c=_(a);if(c.isProviderFor(e,r))return M(s),c}}}if(!w(t)&&t.isProviderFor(e,r))return t}function g(t,e){var i,n=r.get(t);return w(n)||(i=n.get(e)),w(i)?(w(i=h(t,e))||(w(n)&&(n=new s,r.set(t,n)),n.set(e,i)),i):i}function p(t){if(w(t))throw new TypeError;return i===t||n===t||!w(o)&&o.has(t)}function f(t,e,i){if(!p(i))throw new Error("Metadata provider not registered.");var n=g(t,e);if(n!==i){if(!w(n))return!1;var o=r.get(t);w(o)&&(o=new s,r.set(t,o)),o.set(e,i)}return!0}}()),!w(d)&&O(e.Reflect)&&Object.isExtensible(e.Reflect)&&Object.defineProperty(e.Reflect,d,{enumerable:!1,configurable:!1,writable:!1,value:t}),t}(),l=function(t){var e=new c,i={isProviderFor:function(t,i){var n=e.get(t);return!w(n)&&n.has(i)},OrdinaryDefineOwnMetadata:function(t,e,i,o){n(i,o,!0).set(t,e)},OrdinaryHasOwnMetadata:function(t,e,i){var o=n(e,i,!1);return!w(o)&&S(o.has(t))},OrdinaryGetOwnMetadata:function(t,e,i){var o=n(e,i,!1);if(!w(o))return o.get(t)},OrdinaryOwnMetadataKeys:function(t,e){var i=[],o=n(t,e,!1);if(w(o))return i;for(var r=R(o.keys()),s=0;;){var a=A(r);if(!a)return i.length=s,i;var c=_(a);try{i[s]=c}catch(t){try{M(r)}finally{throw t}}s++}},OrdinaryDeleteMetadata:function(t,i,o){var r=n(i,o,!1);if(w(r))return!1;if(!r.delete(t))return!1;if(0===r.size){var s=e.get(i);w(s)||(s.delete(o),0===s.size&&e.delete(s))}return!0}};return u.registerProvider(i),i;function n(n,o,r){var a=e.get(n),c=!1;if(w(a)){if(!r)return;a=new s,e.set(n,a),c=!0}var d=a.get(o);if(w(d)){if(!r)return;if(d=new s,a.set(o,d),!t.setProvider(n,o,i))throw a.delete(o),c&&e.delete(n),new Error("Wrong provider for target.")}return d}}(u);function h(t,e,i){if(g(t,e,i))return!0;var n=P(e);return!C(n)&&h(t,n,i)}function g(t,e,i){var n=W(e,i,!1);return!w(n)&&S(n.OrdinaryHasOwnMetadata(t,e,i))}function p(t,e,i){if(g(t,e,i))return f(t,e,i);var n=P(e);return C(n)?void 0:p(t,n,i)}function f(t,e,i){var n=W(e,i,!1);if(!w(n))return n.OrdinaryGetOwnMetadata(t,e,i)}function v(t,e,i,n){W(i,n,!0).OrdinaryDefineOwnMetadata(t,e,i,n)}function y(t,e){var i=m(t,e),n=P(t);if(null===n)return i;var o=y(n,e);if(o.length<=0)return i;if(i.length<=0)return o;for(var r=new a,s=[],c=0,d=i;c<d.length;c++){var u=d[c];r.has(u)||(r.add(u),s.push(u))}for(var l=0,h=o;l<h.length;l++)u=h[l],r.has(u)||(r.add(u),s.push(u));return s}function m(t,e){var i=W(t,e,!1);return i?i.OrdinaryOwnMetadataKeys(t,e):[]}function b(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}function w(t){return void 0===t}function C(t){return null===t}function O(t){return"object"==typeof t?null!==t:"function"==typeof t}function j(t,e){switch(b(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var i=3===e?"string":5===e?"number":"default",o=I(t,n);if(void 0!==o){var r=o.call(t,i);if(O(r))throw new TypeError;return r}return function(t,e){if("string"===e){var i=t.toString;if(E(i)&&!O(o=i.call(t)))return o;if(E(n=t.valueOf)&&!O(o=n.call(t)))return o}else{var n;if(E(n=t.valueOf)&&!O(o=n.call(t)))return o;var o,r=t.toString;if(E(r)&&!O(o=r.call(t)))return o}throw new TypeError}(t,"default"===i?"number":i)}function S(t){return!!t}function k(t){var e=j(t,3);return"symbol"==typeof e?e:function(t){return""+t}(e)}function T(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:"[object Array]"===Object.prototype.toString.call(t)}function E(t){return"function"==typeof t}function Q(t){return"function"==typeof t}function I(t,e){var i=t[e];if(null!=i){if(!E(i))throw new TypeError;return i}}function R(t){var e=I(t,o);if(!E(e))throw new TypeError;var i=e.call(t);if(!O(i))throw new TypeError;return i}function _(t){return t.value}function A(t){var e=t.next();return!e.done&&e}function M(t){var e=t.return;e&&e.call(t)}function P(t){var e=Object.getPrototypeOf(t);if("function"!=typeof t||t===r)return e;if(e!==r)return e;var i=t.prototype,n=i&&Object.getPrototypeOf(i);if(null==n||n===Object.prototype)return e;var o=n.constructor;return"function"!=typeof o||o===t?e:o}function D(t){throw t}function W(t,e,i){var n=u.getProvider(t,e);if(!w(n))return n;if(i){if(u.setProvider(t,e,l))return l;throw new Error("Illegal state.")}}t("decorate",(function(t,e,i,n){if(w(i)){if(!T(t))throw new TypeError;if(!Q(e))throw new TypeError;return function(t,e){for(var i=t.length-1;i>=0;--i){var n=(0,t[i])(e);if(!w(n)&&!C(n)){if(!Q(n))throw new TypeError;e=n}}return e}(t,e)}if(!T(t))throw new TypeError;if(!O(e))throw new TypeError;if(!O(n)&&!w(n)&&!C(n))throw new TypeError;return C(n)&&(n=void 0),function(t,e,i,n){for(var o=t.length-1;o>=0;--o){var r=(0,t[o])(e,i,n);if(!w(r)&&!C(r)){if(!O(r))throw new TypeError;n=r}}return n}(t,e,i=k(i),n)})),t("metadata",(function(t,e){return function(i,n){if(!O(i))throw new TypeError;if(!w(n)&&!function(t){switch(b(t)){case 3:case 4:return!0;default:return!1}}(n))throw new TypeError;v(t,e,i,n)}})),t("defineMetadata",(function(t,e,i,n){if(!O(i))throw new TypeError;return w(n)||(n=k(n)),v(t,e,i,n)})),t("hasMetadata",(function(t,e,i){if(!O(e))throw new TypeError;return w(i)||(i=k(i)),h(t,e,i)})),t("hasOwnMetadata",(function(t,e,i){if(!O(e))throw new TypeError;return w(i)||(i=k(i)),g(t,e,i)})),t("getMetadata",(function(t,e,i){if(!O(e))throw new TypeError;return w(i)||(i=k(i)),p(t,e,i)})),t("getOwnMetadata",(function(t,e,i){if(!O(e))throw new TypeError;return w(i)||(i=k(i)),f(t,e,i)})),t("getMetadataKeys",(function(t,e){if(!O(t))throw new TypeError;return w(e)||(e=k(e)),y(t,e)})),t("getOwnMetadataKeys",(function(t,e){if(!O(t))throw new TypeError;return w(e)||(e=k(e)),m(t,e)})),t("deleteMetadata",(function(t,e,i){if(!O(e))throw new TypeError;w(i)||(i=k(i));var n=W(e,i,!1);return!w(n)&&n.OrdinaryDeleteMetadata(t,e,i)}))}(o,n),void 0===n.Reflect&&(n.Reflect=t)}()}(n||(n={}))},1635:(t,e,i)=>{"use strict";function n(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s}function o(t,e){return function(i,n){e(i,n,t)}}function r(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function s(t,e,i,n){return new(i||(i=Promise))((function(o,r){function s(t){try{c(n.next(t))}catch(t){r(t)}}function a(t){try{c(n.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}c((n=n.apply(t,e||[])).next())}))}i.d(e,{Cg:()=>n,Qj:()=>o,Sn:()=>r,sH:()=>s}),Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError}},n={};function o(t){var e=n[t];if(void 0!==e)return e.exports;var r=n[t]={exports:{}};return i[t](r,r.exports,o),r.exports}o.m=i,o.d=(t,e)=>{for(var i in e)o.o(e,i)&&!o.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},o.f={},o.e=t=>Promise.all(Object.keys(o.f).reduce(((e,i)=>(o.f[i](t,e),e)),[])),o.u=t=>(({23:"nr-agent",60:"compressor",158:"spa-aggregate",189:"session_trace-aggregate",211:"ajax-aggregate",214:"async-api",224:"fandom-gdpr-consents",297:"jserrors-aggregate",301:"page_action-aggregate",319:"static-consents",396:"lazy-feature-loader",452:"metrics-aggregate",482:"fanatical-consents",564:"basic-spa-aggregate",617:"page_view_timing-aggregate",677:"page_view_event-aggregate",777:"recorder",815:"session_replay-aggregate",832:"one-trust-consents",967:"session-manager"}[t]||t)+".js"),o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),t={},e="identity-engine:",o.l=(i,n,r,s)=>{if(t[i])t[i].push(n);else{var a,c;if(void 0!==r)for(var d=document.getElementsByTagName("script"),u=0;u<d.length;u++){var l=d[u];if(l.getAttribute("src")==i||l.getAttribute("data-webpack")==e+r){a=l;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,o.nc&&a.setAttribute("nonce",o.nc),a.setAttribute("data-webpack",e+r),a.src=i),t[i]=[n];var h=(e,n)=>{a.onerror=a.onload=null,clearTimeout(g);var o=t[i];if(delete t[i],a.parentNode&&a.parentNode.removeChild(a),o&&o.forEach((t=>t(n))),e)return e(n)},g=setTimeout(h.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=h.bind(null,a.onerror),a.onload=h.bind(null,a.onload),c&&document.head.appendChild(a)}},o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;o.g.importScripts&&(t=o.g.location+"");var e=o.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var i=e.getElementsByTagName("script");if(i.length)for(var n=i.length-1;n>-1&&(!t||!/^http(s?):/.test(t));)t=i[n--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=t})(),(()=>{var t={57:0};o.f.j=(e,i)=>{var n=o.o(t,e)?t[e]:void 0;if(0!==n)if(n)i.push(n[2]);else{var r=new Promise(((i,o)=>n=t[e]=[i,o]));i.push(n[2]=r);var s=o.p+o.u(e),a=new Error;o.l(s,(i=>{if(o.o(t,e)&&(0!==(n=t[e])&&(t[e]=void 0),n)){var r=i&&("load"===i.type?"missing":i.type),s=i&&i.target&&i.target.src;a.message="Loading chunk "+e+" failed.\n("+r+": "+s+")",a.name="ChunkLoadError",a.type=r,a.request=s,n[1](a)}}),"chunk-"+e,e)}};var e=(e,i)=>{var n,r,[s,a,c]=i,d=0;if(s.some((e=>0!==t[e]))){for(n in a)o.o(a,n)&&(o.m[n]=a[n]);c&&c(o)}for(e&&e(i);d<s.length;d++)r=s[d],o.o(t,r)&&t[r]&&t[r][0](),t[r]=0},i=self.webpackChunkidentity_engine=self.webpackChunkidentity_engine||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))})(),(()=>{"use strict";var t=o(1635),e=(o(698),o(2223));function i(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)t[n]=i[n]}return t}var n,r=function t(e,n){function o(t,o,r){if("undefined"!=typeof document){"number"==typeof(r=i({},n,r)).expires&&(r.expires=new Date(Date.now()+864e5*r.expires)),r.expires&&(r.expires=r.expires.toUTCString()),t=encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var s="";for(var a in r)r[a]&&(s+="; "+a,!0!==r[a]&&(s+="="+r[a].split(";")[0]));return document.cookie=t+"="+e.write(o,t)+s}}return Object.create({set:o,get:function(t){if("undefined"!=typeof document&&(!arguments.length||t)){for(var i=document.cookie?document.cookie.split("; "):[],n={},o=0;o<i.length;o++){var r=i[o].split("="),s=r.slice(1).join("=");try{var a=decodeURIComponent(r[0]);if(n[a]=e.read(s,a),t===a)break}catch(t){}}return t?n[t]:n}},remove:function(t,e){o(t,"",i({},e,{expires:-1}))},withAttributes:function(e){return t(this.converter,i({},this.attributes,e))},withConverter:function(e){return t(i({},this.converter,e),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(e)}})}({read:function(t){return'"'===t[0]&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"}),s=o(5144),a=o(3858),c=o(7393),d=o(1695),u=o(6610);let l=class{constructor(t){this.adsContext=t}get(){var t;return"dev"===(null===(t=this.adsContext.get())||void 0===t?void 0:t.env)?"https://services.fandom-dev."+(location.hostname.match(/(?!\.)(pl|us)$/)||["us"])[0]+"/":"https://services.fandom.com/"}};var h,g,p,f,v;l=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(u.i)),(0,t.Sn)("design:paramtypes",["function"==typeof(n=void 0!==u.i&&u.i)?n:Object])],l);class y extends Error{constructor(t){super(t),this.name="GeoCookieException"}}let m=class{constructor(t,e,i,n,o){this.cookiesManager=t,this.httpClient=e,this.logger=i,this.geo=n,this.serviceBaseUrl=o,this.geoIPUrl=this.serviceBaseUrl.get()+"geoip/location"}setGeoCookieIfNotExist(){return(0,t.sH)(this,void 0,void 0,(function*(){if(this.cookiesManager.get("Geo"))this.logger.info("Geo cookie already exists");else try{const t=yield this.httpClient.get(this.geoIPUrl),{country_code:e,region:i,continent_code:n}=yield t.json(),o={country:e,region:i,continent:n},r=JSON.stringify(o);this.cookiesManager.set("Geo",r,{expires:365}),this.geo.set(o),this.logger.info("Geo cookie set")}catch(t){if(t instanceof a.j)throw new y(`Failed to fetch Geo cookie from pandora: ${t}`);throw new y(`Failed to set Geo cookie: ${t}`)}}))}};m=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(c.AZ)),(0,t.Qj)(1,(0,e.WQ)(a.Q)),(0,t.Qj)(2,(0,e.MR)(s.V,s.O,"GeoCookie")),(0,t.Qj)(3,(0,e.WQ)(d.u)),(0,t.Qj)(4,(0,e.WQ)(l)),(0,t.Sn)("design:paramtypes",["function"==typeof(h="undefined"!=typeof CookiesManager&&CookiesManager)?h:Object,"function"==typeof(g=void 0!==a.Q&&a.Q)?g:Object,"function"==typeof(p=void 0!==s.V&&s.V)?p:Object,"function"==typeof(f=void 0!==d.u&&d.u)?f:Object,"function"==typeof(v=void 0!==l&&l)?v:Object])],m);var b=o(3155),w=o(2349),C=o(9028),O=o(1038),j=o(3710),S=o(7546),k=o(2439);var T,E,Q,I,R,_,A,M,P,D=o(4874);class W{constructor(t,i,n){this.window=t,this.cookiesManager=i,this.communicationService=n,this.cacheStorage={},this.cacheKey="basset";const o=e.kL.resolve(s.V);o.setLoggerGroup("InstantConfig"),this.logger=o,this.resetCache()}resetCache(){const t=this.cookiesManager.get(this.cacheKey)||"";var e;this.cacheStorage=""===(e=t)||"string"!=typeof e?{}:e.split("|").reduce(((t,e)=>Object.assign(Object.assign({},t),function(t){const[e,i]=t.split(":"),n="true"===i,[o,r,s]=e.split("_");return{[o]:{name:o,group:r,limit:parseFloat(s)||void 0,result:n,withCookie:!0}}}(e))),{}),this.logger.info("reset cache",this.cacheStorage)}get(t){return this.cacheStorage[t]}set(t){this.cacheStorage[t.name]=t}remove(t){delete this.cacheStorage[t]}synchronizeCookie(){this.communicationService.on(w.c.CONSENT_READY,(({gdprConsent:t})=>{t&&(this.saveCookie(),this.communicationService.emit(new b.r(w.c.INSTANT_CONFIG_CACHE_READY)))}))}saveCookie(){const t=Object.keys(this.cacheStorage).map((t=>({key:t,value:this.cacheStorage[t]}))).filter((({value:t})=>t.withCookie)).reduce(((t,{key:e,value:i})=>Object.assign(Object.assign({},t),{[e]:i})),{}),e=this.window.location.hostname,i=D.O.extract(e),n=(o=t,Object.keys(o).slice(0,5).map(function(t){return e=>{const{name:i,group:n,limit:o,result:r}=t[e];return`${i}_${n}_${o}:${r}`}}(o)).join("|"));var o;this.cookiesManager.set(this.cacheKey,n,{domain:i,expires:180}),this.logger.info("saved in cookie",this.cacheStorage,n)}}class x{constructor(t,e,i){this.cookiesManager=t,this.communicationService=e,this.topLevelDomain=D.O.extract(i.location.hostname)}get(t){return this.cookiesManager.get(t)}remove(t){this.cookiesManager.remove(t,{domain:this.topLevelDomain})}set(t,e,i){this.communicationService.on(w.c.CONSENT_READY,(n=>{if((!n.geoRequiresSignal||!n.ccpaSignal)&&(!n.geoRequiresConsent||n.gdprConsent)){const n={domain:this.topLevelDomain};i&&(n.expires=i),this.cookiesManager.set(t,e,n)}}))}}let L=class{constructor(t,e,i,n,o,r,s,a,c){this.adsContext=t,this.device=e,this.browser=i,this.platform=n,this.geo=o,this.serviceBaseUrl=r,this.window=s,this.cookiesManager=a,this.logger=c}init(e){return(0,t.sH)(this,arguments,void 0,(function*(t,e={}){var i;const n=null===(i=this.adsContext.get())||void 0===i?void 0:i.env,o=this.serviceBaseUrl.get().slice(0,-1),r=this.platform.get(),s=this.geo.get(),a=`https://script.wikia.nocookie.net/fandom-ae-assets/icbm/${null!=n?n:"prod"}/icbm_state_${r}.json`,c=new C.InstantConfigLoader({appName:r,instantConfigEndpoint:o,instantConfigFallbackEndpoint:a}),d=new W(this.window,this.cookiesManager,t),u=new x(this.cookiesManager,t,this.window),l=new C.InstantConfigInterpreter(new C.BrowserMatcher(this.browser.getBrowser()),new C.DeviceMatcher(this.device.getDeviceType()),new C.DomainMatcher,new C.RegionMatcher(s),d,u);let h=yield c.getConfig();h=(new C.InstantConfigOverrider).override(O.C.getURLSearchParams(),h);const g=l.init(h,e);return this.repository=g.getValues(),d.synchronizeCookie(),this.logger.info("instantiated with",this.repository),this}))}get(t,e){return t in this.repository&&void 0!==this.repository[t]?this.repository[t]:e}};L=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(u.i)),(0,t.Qj)(1,(0,e.WQ)(j.p)),(0,t.Qj)(2,(0,e.WQ)(S.P)),(0,t.Qj)(3,(0,e.WQ)(k.O)),(0,t.Qj)(4,(0,e.WQ)(d.u)),(0,t.Qj)(5,(0,e.WQ)(l)),(0,t.Qj)(6,(0,e.WQ)(c.jf)),(0,t.Qj)(7,(0,e.WQ)(c.AZ)),(0,t.Qj)(8,(0,e.MR)(s.V,s.O,"InstantConfig")),(0,t.Sn)("design:paramtypes",["function"==typeof(T=void 0!==u.i&&u.i)?T:Object,"function"==typeof(E=void 0!==j.p&&j.p)?E:Object,"function"==typeof(Q=void 0!==S.P&&S.P)?Q:Object,"function"==typeof(I=void 0!==k.O&&k.O)?I:Object,"function"==typeof(R=void 0!==d.u&&d.u)?R:Object,"function"==typeof(_=void 0!==l&&l)?_:Object,"function"==typeof(A="undefined"!=typeof Window&&Window)?A:Object,"function"==typeof(M="undefined"!=typeof CookiesManager&&CookiesManager)?M:Object,"function"==typeof(P=void 0!==s.V&&s.V)?P:Object])],L);var G,N,V,U,F,H,$,B,q,z=o(6167),Y=o(2517),K=o(6527);let X=class{constructor(t,e,i,n,o,r,s,a,c){this.cookiesManager=t,this.window=e,this.wikiConfig=i,this.context=n,this.logger=o,this.geo=r,this.uspApi=s,this.instantConfig=a,this.oneTrust=c,this.ageGateCookie="ag",this.ageGateExpiryMs=31536e6}init(e){return(0,t.sH)(this,void 0,void 0,(function*(){var t,i;Boolean(null===(i=null===(t=this.context.get())||void 0===t?void 0:t.targeting)||void 0===i?void 0:i.directedAtChildren)&&this.wikiConfig.get("wgAgeGateEnabled",!1)?void 0===this.cookiesManager.get(this.ageGateCookie)&&(yield this.waitForAgeGateDataAndSetCookie(e)):this.logger.info("disabled")}))}waitForAgeGateDataAndSetCookie(e){return(0,t.sH)(this,void 0,void 0,(function*(){return new Promise((t=>{e.on(w.c.AGE_GATE_DATA,(({payload:e})=>{this.setAgeGateCookie(e),"us"!==this.geo.getCountryCode()||e.adult||this.setUsPrivacyCookie(Y.u.yes),t()}))}))}))}setAgeGateCookie(t){var e,i;t||this.logger.warn("Payload data missing, using defaults");const n=null!==(e=null==t?void 0:t.adult)&&void 0!==e&&e,o=null!==(i=null==t?void 0:t.timestamp)&&void 0!==i?i:Date.now();this.cookiesManager.set(this.ageGateCookie,n?"1":"0",{domain:this.getTopLevelDomain(),expires:new Date(o+this.ageGateExpiryMs)})}setUsPrivacyCookie(t){this.instantConfig.get("icFandom1TEnabled")?this.oneTrust.setConsent(t===Y.u.no):(this.logger.info("[IE] OneTrust Setting US privacy cookie"),this.uspApi.createPrivacyCookie(t))}getTopLevelDomain(){const t=this.window.location.hostname;return D.O.extract(t)}};X=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(c.AZ)),(0,t.Qj)(1,(0,e.WQ)(c.jf)),(0,t.Qj)(2,(0,e.WQ)(z.j)),(0,t.Qj)(3,(0,e.WQ)(u.i)),(0,t.Qj)(4,(0,e.MR)(s.V,s.O,"AgeGate")),(0,t.Qj)(5,(0,e.WQ)(d.u)),(0,t.Qj)(6,(0,e.WQ)(Y.h)),(0,t.Qj)(7,(0,e.WQ)(L)),(0,t.Qj)(8,(0,e.WQ)((0,e.cb)((()=>K.R)))),(0,t.Sn)("design:paramtypes",["function"==typeof(G="undefined"!=typeof CookiesManager&&CookiesManager)?G:Object,"function"==typeof(N="undefined"!=typeof Window&&Window)?N:Object,"function"==typeof(V=void 0!==z.j&&z.j)?V:Object,"function"==typeof(U=void 0!==u.i&&u.i)?U:Object,"function"==typeof(F=void 0!==s.V&&s.V)?F:Object,"function"==typeof(H=void 0!==d.u&&d.u)?H:Object,"function"==typeof($=void 0!==Y.h&&Y.h)?$:Object,"function"==typeof(B=void 0!==L&&L)?B:Object,"function"==typeof(q=void 0!==K.R&&K.R)?q:Object])],X);var J,Z,tt,et=o(4085),it=o(2712),nt=o(4489),ot=o(3841);let rt=class{constructor(t,e,i){this.dataWarehouse=t,this.window=e,this.logger=i}activateTracking(){if(!this.isEnabled())return void this.logger.info("Hem Tracking is disabled");const t=this.extractHEMs();Object.keys(t).forEach((e=>{t[e]&&this.dataWarehouse.track(nt.i.identity,{partner_name:"MediaWiki-"+e,partner_identity_id:t[e]})}))}isEnabled(){var t,e,i;return(null===(i=null===(e=null===(t=this.window.ads)||void 0===t?void 0:t.context)||void 0===e?void 0:e.opts)||void 0===i?void 0:i.userEmailHashes)&&this.window.ads.context.opts.userEmailHashes.length>0}extractHEMs(){const[t,e,i]=this.window.ads.context.opts.userEmailHashes;return{md5:t,sha1:e,sha256:i}}};var st,at;rt=(0,t.Cg)([(0,e._G)(),(0,t.Qj)(0,(0,e.WQ)(ot.X)),(0,t.Qj)(1,(0,e.WQ)(c.jf)),(0,t.Qj)(2,(0,e.MR)(s.V,s.O,"HemTracking")),(0,t.Sn)("design:paramtypes",["function"==typeof(J=void 0!==ot.X&&ot.X)?J:Object,"function"==typeof(Z="undefined"!=typeof Window&&Window)?Z:Object,"function"==typeof(tt=void 0!==s.V&&s.V)?tt:Object])],rt),function(t){t.tracking="tracking",t.page="page",t.site="site",t.partners="partners",t.targeting="targeting"}(at||(at={}));let ct=class{constructor(t){this.window=t}get(t,e){return this.window.fandomContext[t][e]}set(t,e,i){this.window.fandomContext&&this.window.fandomContext[t]||(this.window.fandomContext=Object.assign(Object.assign({},this.window.fandomContext),{[t]:{}})),this.window.fandomContext[t][e]=i.value}remove(t,e){try{delete this.window.fandomContext[t][e]}catch(t){}}};var dt;ct=(0,t.Cg)([(0,e._G)(),(0,t.Qj)(0,(0,e.WQ)(c.jf)),(0,t.Sn)("design:paramtypes",["function"==typeof(st="undefined"!=typeof Window&&Window)?st:Object])],ct);let ut=class{constructor(t){this.cookiesManager=t}get(t){return this.cookiesManager.get(t)}set(t,e){const{value:i,domain:n,expiresMS:o}=e,r=new Date((new Date).getTime()+o);this.cookiesManager.set(t,i.toString(),{domain:n,expires:r})}remove(t){this.cookiesManager.remove(t)}};ut=(0,t.Cg)([(0,e._G)(),(0,t.Qj)(0,(0,e.WQ)(c.AZ)),(0,t.Sn)("design:paramtypes",["function"==typeof(dt="undefined"!=typeof CookiesManager&&CookiesManager)?dt:Object])],ut);let lt=class{generate(){let t="";for(;t.length<10;)t+="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_-"[64*Math.random()|0];return t}generateV2(){return`${this.generate()}.${Date.now()}`}};var ht;lt=(0,t.Cg)([(0,e._G)()],lt);let gt=class{constructor(t){this.cookiesManager=t}getNextNumberFromCookie(t){const e=parseInt(this.cookiesManager.get(t));return Number.isNaN(e)?1:e+1}};var pt,ft,vt,yt,mt,bt,wt,Ct;gt=(0,t.Cg)([(0,e._G)(),(0,t.Qj)(0,(0,e.WQ)(c.AZ)),(0,t.Sn)("design:paramtypes",["function"==typeof(ht="undefined"!=typeof CookiesManager&&CookiesManager)?ht:Object])],gt);const Ot=18e5,jt=15552e6;let St=class{constructor(t,e,i,n,o,r,s,a){this.contextRepository=t,this.cookieRepository=e,this.uuid=i,this.beaconGenerator=n,this.pageViewNumberGenerator=o,this.window=r,this.wikiConfig=s,this.communicationService=a,this.communicationService.on(w.c.PAGE_CHANGED,(()=>{this.updatePageViewData()}))}set(t,e){this.contextRepository.set(at.tracking,t,e),this.cookieRepository.set(t,e)}remove(t){this.contextRepository.remove(at.tracking,t),this.cookieRepository.remove(t)}updatePageViewData(){const t=this.window.location.hostname,e=D.O.extract(t);this.contextRepository.set(at.tracking,"pvUID",{domain:t,expiresMS:Ot,value:this.wikiConfig.get("pvUID")||this.window.pvUID||this.uuid()}),this.set("pvNumber",{domain:t,expiresMS:Ot,value:this.pageViewNumberGenerator.getNextNumberFromCookie("pvNumber")}),this.set("pvNumberGlobal",{domain:e,expiresMS:Ot,value:this.pageViewNumberGenerator.getNextNumberFromCookie("pvNumberGlobal")})}updateUserTrackingData(){const t=this.window.location.hostname,e=D.O.extract(t),i=this.cookieRepository.get("wikia_beacon_id")||this.cookieRepository.get("beaconId"),n={domain:e,expiresMS:jt,value:i||this.beaconGenerator.generate()};this.contextRepository.set(at.tracking,"beaconId",n),this.cookieRepository.set("wikia_beacon_id",n);const o={domain:e,expiresMS:63072e6,value:this.cookieRepository.get("_b2")||this.beaconGenerator.generateV2()};this.cookieRepository.set("_b2",o);const r=this.wikiConfig.get("sessionId",this.window.sessionId)||this.cookieRepository.get("sessionId"),s={domain:e,expiresMS:Ot,value:r||this.uuid()};this.set("sessionId",s);const a=this.cookieRepository.get("wikia_session_id");this.cookieRepository.set("wikia_session_id",{domain:e,expiresMS:jt,value:a||this.beaconGenerator.generate()})}setup(){this.updateUserTrackingData(),this.updatePageViewData()}clear(){this.remove("beaconId"),this.remove("sessionId"),this.remove("pvNumber"),this.remove("pvNumberGlobal")}};St=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(ct)),(0,t.Qj)(1,(0,e.WQ)(ut)),(0,t.Qj)(2,(0,e.WQ)(c.kk)),(0,t.Qj)(3,(0,e.WQ)(lt)),(0,t.Qj)(4,(0,e.WQ)(gt)),(0,t.Qj)(5,(0,e.WQ)(c.jf)),(0,t.Qj)(6,(0,e.WQ)(z.j)),(0,t.Qj)(7,(0,e.WQ)(et.U)),(0,t.Sn)("design:paramtypes",["function"==typeof(pt=void 0!==ct&&ct)?pt:Object,"function"==typeof(ft=void 0!==ut&&ut)?ft:Object,"function"==typeof(vt="undefined"!=typeof UuidProvider&&UuidProvider)?vt:Object,"function"==typeof(yt=void 0!==lt&&lt)?yt:Object,"function"==typeof(mt=void 0!==gt&&gt)?mt:Object,"function"==typeof(bt="undefined"!=typeof Window&&Window)?bt:Object,"function"==typeof(wt=void 0!==z.j&&z.j)?wt:Object,"function"==typeof(Ct=void 0!==et.U&&et.U)?Ct:Object])],St);var kt,Tt=o(5369);let Et=class{constructor(t){this.sentry=t}resolve(t,e,i){var n;t.geoRequiresConsent&&t.gdprConsent||t.geoRequiresSignal&&!t.ccpaSignal||!t.geoRequiresSignal&&!t.geoRequiresConsent?(this.consentGiven=!0,null===(n=e())||void 0===n||n.catch((t=>this.sentry.captureException(t)))):(t.geoRequiresSignal&&t.ccpaSignal||t.geoRequiresConsent&&!t.gdprConsent)&&(this.consentGiven=!1,i())}getConsents(){return this.consentGiven}};var Qt,It;Et=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(c.eF)),(0,t.Sn)("design:paramtypes",["function"==typeof(kt=void 0!==Tt.t&&Tt.t)?kt:Object])],Et),function(t){t.LOCAL="local",t.IDENTITY_STORAGE="identity_storage"}(Qt||(Qt={}));class Rt{constructor(t){this.storage=t}getItem(t){const e=this.storage.getItem(t);try{return null!==e?JSON.parse(e):null}catch(t){return e}}setItem(t,e){const i=e instanceof Object?JSON.stringify(e):e;this.storage.setItem(t,i)}removeItem(t){return this.storage.removeItem(t)}}let _t=class{constructor(t){this.storageAdapter=new Rt(t.localStorage)}getItem(t){return this.storageAdapter.getItem(t)}setItem(t,e){try{this.storageAdapter.setItem(t,e)}catch(t){}}removeItem(t){return this.storageAdapter.removeItem(t)}};var At,Mt,Pt,Dt,Wt;_t=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(c.jf)),(0,t.Sn)("design:paramtypes",["function"==typeof(It="undefined"!=typeof Window&&Window)?It:Object])],_t);let xt=class{constructor(t,e,i,n,o){this.logger=t,this.uuid=e,this.storage=i,this.serviceBaseUrl=n,this.httpClient=o,this.logGroup="identity-storage",this.IdentityStorageKey="identity",this.identityServiceUrl=this.serviceBaseUrl.get()+"identity-storage/"}fetchData(){return(0,t.sH)(this,void 0,void 0,(function*(){try{const t=yield this.httpClient.get(this.identityServiceUrl,{mode:"cors",credentials:"include"});return 200===t.status||202===t.status?t.json():this.createFallbackResponse()}catch(t){return this.logger.info(this.logGroup,"Loading Identity LocalStorage data failed",t),this.createFallbackResponse()}}))}postData(e){return(0,t.sH)(this,void 0,void 0,(function*(){const t={ppid:e.ppid},i=this.identityServiceUrl+"identity";return(yield this.httpClient.put(i,t,{mode:"cors",credentials:"include"})).json()}))}getLocalData(){return this.storage.getItem(this.IdentityStorageKey)}setLocalData(t){this.storage.setItem(this.IdentityStorageKey,t)}createFallbackResponse(){return{timestamp:Date.now(),over18:!1,synced:!1,ppid:this.uuid()}}};var Lt,Gt,Nt,Vt,Ut,Ft;xt=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.MR)(s.V,s.O,"UserIdentity")),(0,t.Qj)(1,(0,e.WQ)(c.kk)),(0,t.Qj)(2,(0,e.WQ)(_t)),(0,t.Qj)(3,(0,e.WQ)(l)),(0,t.Qj)(4,(0,e.WQ)(a.Q)),(0,t.Sn)("design:paramtypes",["function"==typeof(At=void 0!==s.V&&s.V)?At:Object,"function"==typeof(Mt="undefined"!=typeof UuidProvider&&UuidProvider)?Mt:Object,"function"==typeof(Pt=void 0!==_t&&_t)?Pt:Object,"function"==typeof(Dt=void 0!==l&&l)?Dt:Object,"function"==typeof(Wt=void 0!==a.Q&&a.Q)?Wt:Object])],xt);let Ht=class{constructor(t,e,i,n,o,r){this.storage=t,this.logger=e,this.windowContextRepository=i,this.instantConfigService=n,this.identityStorageClient=o,this.sentry=r}get(){return(0,t.sH)(this,void 0,void 0,(function*(){const t=yield this.getLocalData();return t&&!t.synced&&this.setRemote(t),!t||this.isDeprecated(t)?this.getRemote():(this.setIdentityContextVariables(t),t)}))}setRemote(e){return(0,t.sH)(this,void 0,void 0,(function*(){try{yield this.identityStorageClient.postData(e);const t=Object.assign(Object.assign({},this.identityStorageClient.getLocalData()),{synced:!0});return this.setIdentityContextVariables(t),this.identityStorageClient.setLocalData(Object.assign(Object.assign({},t),{timestamp:Date.now()})),t}catch(t){this.sentry.captureException(t),this.logger.error("Updating Identity LocalStorage data failed")}}))}isDeprecated(t){const e=this.instantConfigService.get("icIdentityTtl",6048e5),i=Date.now()-e;return!t.timestamp||t.timestamp-i<0}getLocalData(){return(0,t.sH)(this,void 0,void 0,(function*(){let t=yield this.identityStorageClient.getLocalData();if(!t){const e=this.getLocalPPID()||this.getAdmsPPID();e&&(t=yield this.migrateDeprecatedIdentity(e))}return t}))}migrateDeprecatedIdentity(e){return(0,t.sH)(this,void 0,void 0,(function*(){const t=yield this.setRemote({ppid:e,synced:!1});return this.clearDeprecatedLocalPpid(),t}))}getAdmsPPID(){var t,e;const i=this.storage.getItem("silver-surfer-active-data-v2");return null===(e=null===(t=null==i?void 0:i.IDENTITY)||void 0===t?void 0:t[0].payload)||void 0===e?void 0:e.identityToken}getLocalPPID(){return this.storage.getItem("ppid")}clearDeprecatedLocalPpid(){this.storage.removeItem("ppid")}getRemote(){return(0,t.sH)(this,void 0,void 0,(function*(){const t=yield this.identityStorageClient.fetchData();return this.setIdentityContextVariables(t),this.identityStorageClient.setLocalData(Object.assign(Object.assign({},t),{timestamp:Date.now()})),t}))}setIdentityContextVariables(t){t.over18&&this.windowContextRepository.set(at.tracking,"over_18",{value:"1"})}};var $t,Bt;Ht=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(_t)),(0,t.Qj)(1,(0,e.MR)(s.V,s.O,"UserIdentity")),(0,t.Qj)(2,(0,e.WQ)(ct)),(0,t.Qj)(3,(0,e.WQ)(L)),(0,t.Qj)(4,(0,e.WQ)(xt)),(0,t.Qj)(5,(0,e.WQ)(c.eF)),(0,t.Sn)("design:paramtypes",["function"==typeof(Lt=void 0!==_t&&_t)?Lt:Object,"function"==typeof(Gt=void 0!==s.V&&s.V)?Gt:Object,"function"==typeof(Nt=void 0!==ct&&ct)?Nt:Object,"function"==typeof(Vt=void 0!==L&&L)?Vt:Object,"function"==typeof(Ut=void 0!==xt&&xt)?Ut:Object,"function"==typeof(Ft=void 0!==Tt.t&&Tt.t)?Ft:Object])],Ht);let qt=class{constructor(t,e){this.logger=t,this.identityStorageService=e}get(){return(0,t.sH)(this,void 0,void 0,(function*(){const t=yield this.identityStorageService.get();return this.logger.info(t),t.ppid}))}};var zt,Yt,Kt;qt=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.MR)(s.V,s.O,"UserIdentity")),(0,t.Qj)(1,(0,e.WQ)(Ht)),(0,t.Sn)("design:paramtypes",["function"==typeof($t=void 0!==s.V&&s.V)?$t:Object,"function"==typeof(Bt=void 0!==Ht&&Ht)?Bt:Object])],qt);let Xt=class{constructor(t,e,i){this.logger=t,this.uuid=e,this.storage=i}get(){return Promise.resolve(this.storage.getItem("ppid")||this.generatePPID())}generatePPID(){this.logger.info("did not found a PPID in LocalStorage");const t=this.uuid();return this.storage.setItem("ppid",t),t}};var Jt,Zt,te,ee,ie,ne,oe;Xt=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.MR)(s.V,s.O,"UserIdentity")),(0,t.Qj)(1,(0,e.WQ)(c.kk)),(0,t.Qj)(2,(0,e.WQ)(_t)),(0,t.Sn)("design:paramtypes",["function"==typeof(zt=void 0!==s.V&&s.V)?zt:Object,"function"==typeof(Yt="undefined"!=typeof UuidProvider&&UuidProvider)?Yt:Object,"function"==typeof(Kt=void 0!==_t&&_t)?Kt:Object])],Xt);let re=class{constructor(t,e,i,n,o,r,s){this.dataWarehouse=t,this.logger=e,this.windowContextRepository=i,this.instantConfigService=n,this.identityStorageRepository=o,this.localStorageRepository=r,this.communicationService=s}getPPID(t){switch(this.logger.info("active strategy: ",t),t){case Qt.IDENTITY_STORAGE:return this.identityStorageRepository;case Qt.LOCAL:default:return this.localStorageRepository}}generatePPID(){return(0,t.sH)(this,void 0,void 0,(function*(){try{const t=this.instantConfigService.get("icPpidRepository",Qt.LOCAL),e=yield this.getPPID(t).get();this.dataWarehouse.track(nt.i.identity,{partner_name:"Google",partner_identity_id:e}),this.communicationService.emit(new b.r(w.c.IDENTITY_PARTNER_DATA_OBTAINED,{payload:{partnerName:"Google",partnerIdentityId:e}})),this.windowContextRepository.set(at.tracking,"ppid",{value:e}),this.logger.info("Passed PPID to page-level targeting")}catch(t){this.logger.error("Setting up PPID has failed!",t)}}))}setPpid(){return(0,t.sH)(this,void 0,void 0,(function*(){this.instantConfigService.get("icPpid",!1)?(this.logger.info("enabled - awaiting setup"),yield this.generatePPID()):this.logger.info("disabled")}))}};var se,ae,ce,de;re=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(ot.X)),(0,t.Qj)(1,(0,e.MR)(s.V,s.O,"UserIdentity")),(0,t.Qj)(2,(0,e.WQ)(ct)),(0,t.Qj)(3,(0,e.WQ)(L)),(0,t.Qj)(4,(0,e.WQ)(qt)),(0,t.Qj)(5,(0,e.WQ)(Xt)),(0,t.Qj)(6,(0,e.WQ)(et.U)),(0,t.Sn)("design:paramtypes",["function"==typeof(Jt=void 0!==ot.X&&ot.X)?Jt:Object,"function"==typeof(Zt=void 0!==s.V&&s.V)?Zt:Object,"function"==typeof(te=void 0!==ct&&ct)?te:Object,"function"==typeof(ee=void 0!==L&&L)?ee:Object,"function"==typeof(ie=void 0!==qt&&qt)?ie:Object,"function"==typeof(ne=void 0!==Xt&&Xt)?ne:Object,"function"==typeof(oe=void 0!==et.U&&et.U)?oe:Object])],re);let ue=class{constructor(t,e,i,n){this.window=t,this.logger=e,this.context=i,this.cookieRepository=n,this.createPartnersContext()}createPartnersContext(){this.window.fandomContext&&this.window.fandomContext.partners||(this.window.fandomContext=Object.assign(Object.assign({},this.window.fandomContext),{partners:{}}))}setIsCoppaSubjectInContext(t){this.coppaSubject=t,this.window.fandomContext.partners.directedAtChildren=t,this.window.fandomContext.partners.blockthrough={directedAtChildren:t}}isCoppaSubject(){return void 0===this.coppaSubject?this.resolveCoppaStatus():this.coppaSubject}resolveCoppaStatus(){var t,e;if(!Boolean(null===(e=null===(t=this.context.get())||void 0===t?void 0:t.targeting)||void 0===e?void 0:e.directedAtChildren))return this.setIsCoppaSubjectInContext(!1),!1;try{const t="1"!==this.cookieRepository.get("ag");return this.setIsCoppaSubjectInContext(t),t}catch(t){this.logger.error("Error while reading age gate cookie")}}};ue=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(c.jf)),(0,t.Qj)(1,(0,e.MR)(s.V,s.O,"CoppaSubject")),(0,t.Qj)(2,(0,e.WQ)(u.i)),(0,t.Qj)(3,(0,e.WQ)(ut)),(0,t.Sn)("design:paramtypes",["function"==typeof(se="undefined"!=typeof Window&&Window)?se:Object,"function"==typeof(ae=void 0!==s.V&&s.V)?ae:Object,"function"==typeof(ce=void 0!==u.i&&u.i)?ce:Object,"function"==typeof(de=void 0!==ut&&ut)?de:Object])],ue);var le,he,ge,pe,fe,ve=o(8978);let ye=class{constructor(t,e,i,n,o){this.platform=e,this.window=i,this.httpClient=n,this.logger=o,this.enabled=!1,this.endpoint=`${t.get()}adeng/api/identity/metrics`}isReportingEnabled(t){const e=t.get("icMonitorTrafficThreshold",{identity:0});return!!(0,ve.A)()||"object"==typeof(i=e)&&!Array.isArray(i)&&null!==i&&(null==e?void 0:e.identity)>0&&e.identity>=100*Math.random();var i}init(t){var e;this.enabled=this.isReportingEnabled(t),this.logger.info(`Metric reporter enabled: ${this.enabled}`),this.enabled&&("complete"===this.window.document.readyState?this.sendPerformanceMetrics():null===(e=this.window)||void 0===e||e.addEventListener("load",(()=>this.sendPerformanceMetrics())))}sendIdentityEngineState(t){this.enabled&&this.send(t)}sendConsentEvent(t){this.enabled&&this.send("opt"+(t?"in":"out"))}sendPerformanceMetrics(){const t=this.window.performance.getEntriesByType("navigation");if(t.length>0){const e=t[0].domContentLoadedEventEnd,i=t[0].loadEventEnd;this.send("document_content_loaded",Math.round(e>0?e:this.logger.getTimeDelta())),this.send("document_load_time",Math.round(i>0?i:this.logger.getTimeDelta()))}}send(t,e){if(!this.enabled)return;const i=new URL(this.endpoint);i.searchParams.set("app",this.platform.get()),i.searchParams.set("action",t),i.searchParams.set("duration",e?e.toString():Math.round(this.logger.getTimeDelta()).toString()),this.httpClient.get(i.toString(),{mode:"cors"},2e3).catch((()=>{this.logger.error("Failed to send data")}))}};var me;ye=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(l)),(0,t.Qj)(1,(0,e.WQ)(k.O)),(0,t.Qj)(2,(0,e.WQ)(c.jf)),(0,t.Qj)(3,(0,e.WQ)(a.Q)),(0,t.Qj)(4,(0,e.MR)(s.V,s.O,"MetricReporterService")),(0,t.Sn)("design:paramtypes",["function"==typeof(le=void 0!==l&&l)?le:Object,"function"==typeof(he=void 0!==k.O&&k.O)?he:Object,"function"==typeof(ge="undefined"!=typeof Window&&Window)?ge:Object,"function"==typeof(pe=void 0!==a.Q&&a.Q)?pe:Object,"function"==typeof(fe=void 0!==s.V&&s.V)?fe:Object])],ye);let be=class{constructor(t){this.storageAdapter=new Rt(t.sessionStorage)}getItem(t){return this.storageAdapter.getItem(t)}setItem(t,e){try{this.storageAdapter.setItem(t,e)}catch(t){}}removeItem(t){return this.storageAdapter.removeItem(t)}};be=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(c.jf)),(0,t.Sn)("design:paramtypes",["function"==typeof(me="undefined"!=typeof Window&&Window)?me:Object])],be);var we,Ce,Oe,je,Se,ke,Te,Ee=o(3248);let Qe=class{constructor(t,e,i,n,o,r,s){this.assetLoader=t,this.consentResolver=e,this.instantConfigService=i,this.coppaSubject=n,this.dataWarehouse=o,this.logger=r,this.metricReporter=s,this.partnerName="liveConnect",this.liveConnectScriptUrl="https://b-code.liadm.com/a-07ev.min.js",this.fallbackQf="0.3",this.live_connect_tracking_events={LIVE_CONNECT_STARTED:"live_connect_started",LIVE_CONNECT_CACHED:"live_connect_cached",LIVE_CONNECT_RESPONDED_UUID:"live_connect_responded_uuid"},this.idConfigMapping=[{id:"unifiedId",name:`${this.partnerName}-unifiedId`},{id:"sha2",name:this.partnerName,params:{qf:"0.3",resolve:"sha2"}},{id:"md5",name:`${this.partnerName}-md5`,params:{qf:"0.3",resolve:"md5"}},{id:"sha1",name:`${this.partnerName}-sha1`,params:{qf:"0.3",resolve:"sha1"}}]}isEnabled(){return this.consentResolver.getConsents()&&this.instantConfigService.get("icLiveConnect")&&this.instantConfigService.get("icLiveConnectCachingStrategy")&&this.instantConfigService.get("icIdentityPartners")&&!this.coppaSubject.isCoppaSubject()}init(){return(0,t.sH)(this,void 0,void 0,(function*(){this.isEnabled()?(this.setupStorage(),this.shouldLoadScript()?(this.logger.info("loading"),this.dataWarehouse.track(nt.i.loadTime,this.live_connect_tracking_events.LIVE_CONNECT_STARTED),this.assetLoader.loadScript(this.liveConnectScriptUrl,"text/javascript",!1).then((()=>{this.logger.info("loaded"),this.resolveAndTrackIds(),this.logEvent("live-connect-requested")}))):(this.dataWarehouse.track(nt.i.loadTime,this.live_connect_tracking_events.LIVE_CONNECT_CACHED),this.logger.info(`already loaded and available in ${this.storageConfig.type}Storage`))):this.logger.info("disabled")}))}resolveAndTrackIds(){var t;if(!window.liQ)return void this.logger.warn("window.liQ not available for tracking");const e=null===(t=this.instantConfigService.get("icLiveConnectQf"))||void 0===t?void 0:t.toString();window.liQ.resolve((t=>{this.trackIds(t)}),(t=>{console.error(t)}),{qf:e||this.fallbackQf,resolve:this.idConfigMapping.map((t=>t.id))})}trackIds(t){this.logger.info("resolve response:",t),Object.keys(t).forEach((e=>{if(!t[e])return;const i=this.getTrackingKeyName(e);if(this.isAvailableInStorage(i))return;"unifiedId"===e&&this.dataWarehouse.track(nt.i.loadTime,this.live_connect_tracking_events.LIVE_CONNECT_RESPONDED_UUID);const n=t[e];this.logger.info(`${e}: ${n}`),n&&(this.storage.setItem(i,n,this.storageConfig.ttl),this.dataWarehouse.track(nt.i.identity,{partner_name:i,partner_identity_id:n}))}))}getTrackingKeyName(t){var e;return null===(e=this.idConfigMapping.find((e=>e.id===t)))||void 0===e?void 0:e.name}setupStorage(){this.storageConfig=this.instantConfigService.get("icLiveConnectCachingStrategy"),"local"===this.storageConfig.type?this.storage=e.kL.resolve(_t):this.storage=e.kL.resolve(be)}shouldLoadScript(){var t;if(!this.storageConfig)return!0;let e=!1;for(const i of this.storageConfig.mandatoryParams){const n=null===(t=this.idConfigMapping.find((t=>t.id===i)))||void 0===t?void 0:t.name;if(!this.isAvailableInStorage(n)){e=!0;break}}return e}isAvailableInStorage(t){return!!this.storage.getItem(t)}logEvent(t){this.metricReporter.send(t)}};var Ie,Re,_e;Qe=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(Ee.s)),(0,t.Qj)(1,(0,e.WQ)((0,e.cb)((()=>Et)))),(0,t.Qj)(2,(0,e.WQ)((0,e.cb)((()=>L)))),(0,t.Qj)(3,(0,e.WQ)(ue)),(0,t.Qj)(4,(0,e.WQ)(ot.X)),(0,t.Qj)(5,(0,e.MR)(s.V,s.O,"liveConnect")),(0,t.Qj)(6,(0,e.WQ)(ye)),(0,t.Sn)("design:paramtypes",["function"==typeof(we=void 0!==Ee.s&&Ee.s)?we:Object,"function"==typeof(Ce=void 0!==Et&&Et)?Ce:Object,"function"==typeof(Oe=void 0!==L&&L)?Oe:Object,"function"==typeof(je=void 0!==ue&&ue)?je:Object,"function"==typeof(Se=void 0!==ot.X&&ot.X)?Se:Object,"function"==typeof(ke=void 0!==s.V&&s.V)?ke:Object,"function"==typeof(Te=void 0!==ye&&ye)?Te:Object])],Qe);let Ae=class{constructor(t,e,i){this.logger=t,this.contextRepository=e,this.liveConnect=i}createPartnersContext(){this.contextRepository.set(at.partners,"anyclip",{value:{ppid:this.contextRepository.get(at.tracking,"ppid")}})}initializeTargetingPartners(){return(0,t.sH)(this,void 0,void 0,(function*(){}))}initializeTrackingPartners(){return(0,t.sH)(this,void 0,void 0,(function*(){this.logger.info("Initializing partners"),yield Promise.all([this.liveConnect.init()])}))}};var Me,Pe,De,We;Ae=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.MR)(s.V,s.O,"Partners")),(0,t.Qj)(1,(0,e.WQ)(ct)),(0,t.Qj)(2,(0,e.WQ)(Qe)),(0,t.Sn)("design:paramtypes",["function"==typeof(Ie=void 0!==s.V&&s.V)?Ie:Object,"function"==typeof(Re=void 0!==ct&&ct)?Re:Object,"function"==typeof(_e=void 0!==Qe&&Qe)?_e:Object])],Ae);let xe=class{constructor(t,e,i,n){this.logger=t,this.windowContextRepository=e,this.dataWarehouse=i,this.navigator=n}init(){return(0,t.sH)(this,void 0,void 0,(function*(){var t;if(this.logger.info("FacilitatedTesting init"),null===(t=this.navigator.cookieDeprecationLabel)||void 0===t?void 0:t.getValue){const t=yield this.navigator.cookieDeprecationLabel.getValue();t?(this.logger.info(`Received cookieDeprecationLabel: ${t}`),this.windowContextRepository.set(at.tracking,"chromeLabel",{value:t}),this.dataWarehouse.track(nt.i.chromeLabel,t)):this.logger.info("Received empty cookieDeprecationLabel")}else this.logger.info("cookieDeprecationLabel not available")}))}};var Le,Ge;xe=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.MR)(s.V,s.O,"GooglePrivacySandbox:FacilitatedTesting")),(0,t.Qj)(1,(0,e.WQ)(ct)),(0,t.Qj)(2,(0,e.WQ)(ot.X)),(0,t.Qj)(3,(0,e.WQ)(c.kW)),(0,t.Sn)("design:paramtypes",["function"==typeof(Me=void 0!==s.V&&s.V)?Me:Object,"function"==typeof(Pe=void 0!==ct&&ct)?Pe:Object,"function"==typeof(De=void 0!==ot.X&&ot.X)?De:Object,"function"==typeof(We="undefined"!=typeof Navigator&&Navigator)?We:Object])],xe);let Ne=class{constructor(t,e){this.logger=t,this.facilitatedTesting=e}init(){this.logger.info("GooglePrivacySandbox init"),this.facilitatedTesting.init()}};var Ve,Ue,Fe,He;Ne=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.MR)(s.V,s.O,"GooglePrivacySandbox")),(0,t.Qj)(1,(0,e.WQ)(xe)),(0,t.Sn)("design:paramtypes",["function"==typeof(Le=void 0!==s.V&&s.V)?Le:Object,"function"==typeof(Ge=void 0!==xe&&xe)?Ge:Object])],Ne);let $e=class{constructor(t,e,i,n){this.contextRepository=t,this.browser=e,this.coppaSubject=i,this.consentResolver=n}init(){return(0,t.sH)(this,void 0,void 0,(function*(){!this.coppaSubject.isCoppaSubject()&&this.consentResolver.getConsents()&&(this.setAdTargetingGroup(),this.setBrowser())}))}setBrowser(){this.contextRepository.set(at.targeting,"browser",{value:this.browser.getBrowser().split(" ")[0]})}getRandomGroup(){return 5*Math.ceil(Math.random()%20*20)}setAdTargetingGroup(){const t=this.getRandomGroup(),e=Array.from({length:21},((t,e)=>100-5*e)).filter((e=>e>=t&&e>0));this.contextRepository.set(at.targeting,"adGroup",{value:e.toString()})}};var Be,qe,ze;$e=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(ct)),(0,t.Qj)(1,(0,e.WQ)(S.P)),(0,t.Qj)(2,(0,e.WQ)(ue)),(0,t.Qj)(3,(0,e.WQ)(Et)),(0,t.Sn)("design:paramtypes",["function"==typeof(Ve=void 0!==ct&&ct)?Ve:Object,"function"==typeof(Ue=void 0!==S.P&&S.P)?Ue:Object,"function"==typeof(Fe=void 0!==ue&&ue)?Fe:Object,"function"==typeof(He=void 0!==Et&&Et)?He:Object])],$e);let Ye=class{constructor(t,e,i){this.partnersService=t,this.adTargetingGroups=e,this.logger=i}initializeTargeting(){return(0,t.sH)(this,void 0,void 0,(function*(){this.logger.info("Setting up targeting"),yield this.partnersService.initializeTargetingPartners(),yield this.adTargetingGroups.init()}))}};var Ke,Xe,Je,Ze,ti;Ye=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(Ae)),(0,t.Qj)(1,(0,e.WQ)($e)),(0,t.Qj)(2,(0,e.MR)(s.V,s.O,"TargetingService")),(0,t.Sn)("design:paramtypes",["function"==typeof(Be=void 0!==Ae&&Ae)?Be:Object,"function"==typeof(qe=void 0!==$e&&$e)?qe:Object,"function"==typeof(ze=void 0!==s.V&&s.V)?ze:Object])],Ye);let ei=class{constructor(t,e,i,n,o){var r,s,a;this.sentry=t,this.browser=e,this.device=i,this.platform=n,this.geo=o,this.sentry.setTags({browser:this.browser.getBrowser(),device:this.device.getDeviceType(),platform:this.platform.get(),geo_country:null!==(r=this.geo.getCountryCode())&&void 0!==r?r:"",geo_continent:null!==(s=this.geo.getContinentCode())&&void 0!==s?s:"",geo_region:null!==(a=this.geo.getRegionCode())&&void 0!==a?a:""})}};var ii,ni;ei=(0,t.Cg)([(0,e._G)(),(0,t.Qj)(0,(0,e.WQ)(c.eF)),(0,t.Qj)(1,(0,e.WQ)(S.P)),(0,t.Qj)(2,(0,e.WQ)(j.p)),(0,t.Qj)(3,(0,e.WQ)(k.O)),(0,t.Qj)(4,(0,e.WQ)(d.u)),(0,t.Sn)("design:paramtypes",["function"==typeof(Ke=void 0!==Tt.t&&Tt.t)?Ke:Object,"function"==typeof(Xe=void 0!==S.P&&S.P)?Xe:Object,"function"==typeof(Je=void 0!==j.p&&j.p)?Je:Object,"function"==typeof(Ze=void 0!==k.O&&k.O)?Ze:Object,"function"==typeof(ti=void 0!==d.u&&d.u)?ti:Object])],ei);let oi=class{constructor(t,e){this.window=t,this.logger=e,this.queue=[]}install(){this.logger.info("installing consent queue");const t=this;return this.window.consentCallbackQueue=this,this.window.consentCallback=(e,i,n)=>t.push(e,i,n),this}push(t,e,i){this.logger.warn("dialog not resolved, enqueued:",t),this.queue.push({name:t,callback:e,category:i})}};oi=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(c.jf)),(0,t.Qj)(1,(0,e.MR)(s.V,s.O,"ConsentCallbackQueue")),(0,t.Sn)("design:paramtypes",["function"==typeof(ii="undefined"!=typeof Window&&Window)?ii:Object,"function"==typeof(ni=void 0!==s.V&&s.V)?ni:Object])],oi);var ri=o(8569);const si={C0001:"necessary",C0002:"performance",C0003:"functional",C0004:"targeting",C0005:"social"};class ai{constructor(t,e){this.container=t;const i=t.OptanonWrapper;t.OptanonWrapper=()=>{e.resolve(),null==i||i()}}available(){return void 0!==this.container.OneTrust}ready(){var t,e;const i=this.container.OneTrust;return void 0!==this.container.OnetrustActiveGroups&&("opt-in"!==(null===(e=null===(t=i.GetDomainData())||void 0===t?void 0:t.ConsentModel)||void 0===e?void 0:e.Name)||i.IsAlertBoxClosed())}resolve(){var t;return null===(t=this.container.OnetrustActiveGroups)||void 0===t?void 0:t.split(",").map((t=>si[t])).filter((t=>t)).reduce(((t,e)=>Object.assign(Object.assign({},t),{[e]:!0})),{})}}class ci{constructor(t,e){this.optIn=t,this.cookiesManager=e}available(){return void 0!==this.cookiesManager.get("OptanonConsent")}ready(){return!this.optIn||void 0!==this.cookiesManager.get("OptanonAlertBoxClosed")}resolve(){var t;const e=null===(t=decodeURIComponent(this.cookiesManager.get("OptanonConsent")))||void 0===t?void 0:t.match(/groups=([^&]+)/);return e&&e[1]?e[1].toUpperCase().split(",").map((t=>{const e=t.split(":");return"1"===e[1]?si[e[0]]:void 0})).filter((t=>t)).reduce(((t,e)=>Object.assign(Object.assign({},t),{[e]:!0})),{}):{}}}var di,ui,li,hi;const gi={necessary:!0},pi={necessary:!0,performance:!0,functional:!0,targeting:!0,social:!0};let fi=class{constructor(t,e,i,n){this.container=t,this.logger=e,this.geo=i,this.cookiesManager=n,this.queue=t.consentCallbackQueue,this.optIn=!!i&&ri.e.includes(this.geo.getCountryCode()),void 0!==this.queue&&this.init()}resolve(){return!!this.wasResolved()||(this.ifAvailableThenResolveIfReady(this.apiConsentResolver)?(this.logger.info("API available, resolved?:",this.categories),this.wasResolved()):!!this.ifAvailableThenResolveIfReady(this.cookieConsentResolver)&&(this.logger.info("Cookies available, resolved?:",this.categories),this.wasResolved()))}wasResolved(){return void 0!==this.categories}init(){this.logger.info("Setting up with opt-in status:",this.optIn),this.apiConsentResolver=new ai(this.container,this),this.cookieConsentResolver=new ci(this.optIn,this.cookiesManager),this.resolve()||setTimeout((()=>this.resolveWithFallback()),5e3)}resolveWithFallback(){this.resolve()||(this.apiConsentResolver.available()||this.cookieConsentResolver.available()?(this.logger.info("Still waiting for consent resolve with available api:",this.apiConsentResolver.available(),"or cookie:",this.cookieConsentResolver.available()),setTimeout((()=>this.resolveWithFallback),5e3)):(this.categories=this.fallback(),this.logger.info("Unable to resolve consent, fallback to:",this.categories),this.resolveQueue()))}ifAvailableThenResolveIfReady(t){const e=t.available();return e&&t.ready()&&(this.categories=t.resolve(),this.resolveQueue()),e}checkAndRun(t,e,i){return this.logger.info("About to callback:",t,"for:",i,"with:",this.categories),!(void 0!==i&&!this.categories[i]||(e(this.categories),0))}resolveQueue(){this.flushQueue(),this.queue.push=(t,e,i)=>this.checkAndRun(t,e,i),this.container.consentCallback=(t,e,i)=>this.checkAndRun(t,e,i)}flushQueue(){const t=this.queue.queue;this.logger.info("Consent resolved, flushing queue of size:",t.length);for(let e=t.length-1;e>=0;e--){const i=t[e];this.checkAndRun(i.name,i.callback,i.category)&&t.splice(e,1)}}fallback(){return this.optIn?gi:pi}};function vi(t){var e,i;return null===(i=null===(e=null==t?void 0:t.replace("/identity-service/",""))||void 0===e?void 0:e.replace("/index.js",""))||void 0===i?void 0:i.replace(/^v/,"")}fi=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(c.jf)),(0,t.Qj)(1,(0,e.MR)(s.V,s.O,"ConsentCallbackQueueHandler")),(0,t.Qj)(3,(0,e.WQ)(c.AZ)),(0,t.Sn)("design:paramtypes",["function"==typeof(di="undefined"!=typeof Window&&Window)?di:Object,"function"==typeof(ui=void 0!==s.V&&s.V)?ui:Object,"function"==typeof(li=void 0!==d.u&&d.u)?li:Object,"function"==typeof(hi="undefined"!=typeof CookiesManager&&CookiesManager)?hi:Object])],fi);class yi{constructor(t){this.options=t}isEnabled(){return e.kL.resolve(L).get("icNewRelic")}load(){return(0,t.sH)(this,void 0,void 0,(function*(){const t=this.isEnabled();if(console.log("[IE] NewRelic is "+(t?"enabled":"disabled")),!t)return;if(Math.random()>this.options.sampleRate)return;console.log(this.options);const{MicroAgent:e}=yield o.e(23).then(o.bind(o,4167));this.agent=new e({info:{beacon:"bam.eu01.nr-data.net",errorBeacon:"bam.eu01.nr-data.net",licenseKey:"NRJS-b979b7ac62a2815b308",applicationID:"538605062",sa:1},loader_config:{accountID:"4475772",trustKey:"4475772",agentID:"538605062",licenseKey:"NRJS-b979b7ac62a2815b308",applicationID:"538605062"},init:{ajax:{enabled:!1},distributed_tracing:{enabled:!1},jserrors:{enabled:!0},metrics:{enabled:!0},page_action:{enabled:!0},page_view_timing:{enabled:!1},session_trace:{enabled:!1},session_replay:{enabled:!1},privacy:{cookies_enabled:!0},spa:{enabled:!1}}})}))}captureException(t){var e;null===(e=this.agent)||void 0===e||e.noticeError(t)}addPageAction(t,e){var i;null===(i=this.agent)||void 0===i||i.addPageAction(t,e)}}var mi,bi,wi,Ci,Oi,ji,Si,ki,Ti,Ei,Qi,Ii,Ri,_i,Ai,Mi,Pi,Di;e.kL.register(c.AZ,{useValue:r}),e.kL.register(c.kk,{useValue:window.crypto.randomUUID.bind(window.crypto)}),e.kL.register(c.kW,{useValue:navigator}),e.kL.register(c.jf,{useValue:window}),e.kL.register(c.kW,{useValue:navigator});let Wi=class{constructor(t,e,i,n,o,r,s,a,c,d,u,l,h,g,p,f,v,y){this.geoCookie=t,this.ageGateHandler=e,this.communicationService=i,this.optInService=n,this.hemTrackingService=o,this.trackingContextSetupService=r,this.consentResolver=s,this.instantConfigService=a,this.window=c,this.logger=d,this.ppidProvider=u,this.coppaSubject=l,this.metricReporterService=h,this.partnersService=g,this.googlePrivacySandbox=p,this.targetingService=y}initializeAgeGateHandler(){return(0,t.sH)(this,void 0,void 0,(function*(){return this.ageGateHandler.init(this.communicationService)}))}updateGTMConsent(t){void 0===this.window.dataLayer&&(this.window.dataLayer=[]),this.window.dataLayer.push({event:"user-consent",consent:t.toString()})}initializeTracking(){return(0,t.sH)(this,void 0,void 0,(function*(){this.logger.info("Setting up tracking"),this.optInService.trackingAllowed=!0,this.hemTrackingService.activateTracking(),yield this.ppidProvider.setPpid(),yield this.partnersService.initializeTrackingPartners(),yield this.partnersService.createPartnersContext(),this.communicationService.emit(new b.r(w.c.IDENTITY_READY)),this.metricReporterService.sendIdentityEngineState("ready"),this.googlePrivacySandbox.init()}))}initializeTargeting(){return(0,t.sH)(this,void 0,void 0,(function*(){yield this.targetingService.initializeTargeting()}))}init(){return(0,t.sH)(this,void 0,void 0,(function*(){yield this.geoCookie.setGeoCookieIfNotExist(),yield this.instantConfigService.init(this.communicationService),this.optInService.init(this.instantConfigService),this.metricReporterService.init(this.instantConfigService),this.metricReporterService.sendIdentityEngineState("init")}))}run(){var e,i;this.logger.info("Starting identity engine",`version: ${vi(null===(i=null===(e=this.window.ads)||void 0===e?void 0:e.version)||void 0===i?void 0:i.identity)}`),this.communicationService.once(w.c.CONSENT_READY,(e=>{this.trackingContextSetupService.setup(),this.consentResolver.resolve(e,(()=>(0,t.sH)(this,void 0,void 0,(function*(){this.metricReporterService.sendConsentEvent(!0),this.updateGTMConsent(!0),yield this.initializeAgeGateHandler(),this.coppaSubject.resolveCoppaStatus(),this.initializeTargeting(),yield this.initializeTracking()}))),(()=>{this.metricReporterService.sendConsentEvent(!1),this.updateGTMConsent(!1),this.initializeTargeting(),this.coppaSubject.resolveCoppaStatus(),this.optInService.trackingAllowed=!1,this.loadPhoenixThirdPartyDisabledMode(),this.communicationService.emit(new b.r(w.c.IDENTITY_READY)),this.metricReporterService.sendIdentityEngineState("ready"),this.logger.info("Tracking rejected")}))}))}loadPhoenixThirdPartyDisabledMode(){var t;(null===(t=null===window||void 0===window?void 0:window.PhoenixLoader)||void 0===t?void 0:t.triggerEvent)?(this.logger.info("Load third party in disabled mode"),window.PhoenixLoader.triggerEvent("loadThirdPartyDisabled")):this.logger.info("No PhoenixLoader.triggerEvent defined")}};Wi=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(m)),(0,t.Qj)(1,(0,e.WQ)(X)),(0,t.Qj)(2,(0,e.WQ)(et.U)),(0,t.Qj)(3,(0,e.WQ)(it.E)),(0,t.Qj)(4,(0,e.WQ)(rt)),(0,t.Qj)(5,(0,e.WQ)(St)),(0,t.Qj)(6,(0,e.WQ)(Et)),(0,t.Qj)(7,(0,e.WQ)(L)),(0,t.Qj)(8,(0,e.WQ)(c.jf)),(0,t.Qj)(9,(0,e.MR)(s.V,s.O,"IdentityEngine")),(0,t.Qj)(10,(0,e.WQ)(re)),(0,t.Qj)(11,(0,e.WQ)(ue)),(0,t.Qj)(12,(0,e.WQ)(ye)),(0,t.Qj)(13,(0,e.WQ)(Ae)),(0,t.Qj)(14,(0,e.WQ)(Ne)),(0,t.Qj)(15,(0,e.WQ)(oi)),(0,t.Qj)(16,(0,e.WQ)(fi)),(0,t.Qj)(17,(0,e.WQ)(Ye)),(0,t.Sn)("design:paramtypes",["function"==typeof(mi=void 0!==m&&m)?mi:Object,"function"==typeof(bi=void 0!==X&&X)?bi:Object,"function"==typeof(wi=void 0!==et.U&&et.U)?wi:Object,"function"==typeof(Ci=void 0!==it.E&&it.E)?Ci:Object,"function"==typeof(Oi=void 0!==rt&&rt)?Oi:Object,"function"==typeof(ji=void 0!==St&&St)?ji:Object,"function"==typeof(Si=void 0!==Et&&Et)?Si:Object,"function"==typeof(ki=void 0!==L&&L)?ki:Object,"function"==typeof(Ti="undefined"!=typeof Window&&Window)?Ti:Object,"function"==typeof(Ei=void 0!==s.V&&s.V)?Ei:Object,"function"==typeof(Qi=void 0!==re&&re)?Qi:Object,"function"==typeof(Ii=void 0!==ue&&ue)?Ii:Object,"function"==typeof(Ri=void 0!==ye&&ye)?Ri:Object,"function"==typeof(_i=void 0!==Ae&&Ae)?_i:Object,"function"==typeof(Ai=void 0!==Ne&&Ne)?Ai:Object,"function"==typeof(Mi=void 0!==oi&&oi)?Mi:Object,"function"==typeof(Pi=void 0!==fi&&fi)?Pi:Object,"function"==typeof(Di=void 0!==Ye&&Ye)?Di:Object])],Wi),function(){(0,t.sH)(this,void 0,void 0,(function*(){var t,i;const n=function(){try{return"US"===e.kL.resolve(d.u).get().country?.01:.1}catch(t){return.01}}(),o=vi(null===(i=null===(t=window.ads)||void 0===t?void 0:t.version)||void 0===i?void 0:i.identity),r=new Tt.t({dsn:"https://3e92e20316cf4539a579d82f4294be77@o4504176096247808.ingest.sentry.io/4505432026447872",release:o,environment:"production",sampleRate:n}),s=new yi({version:`v${o}`,sampleRate:n});try{e.kL.register(c.eF,{useValue:r}),e.kL.register(c.LT,{useValue:s}),e.kL.resolve(ei);const t=e.kL.resolve(Wi);yield t.init(),s.load(),t.run()}catch(t){r.captureException(t),s.captureException(t)}}))}()})()})();
//# sourceMappingURL=index.js.map